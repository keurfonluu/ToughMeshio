
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Generate mesh in Python with Gmsh &#8212; toughio 1.15.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=8fbebee6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=70d5d4a5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/co2_leakage_along_a_fault/1_generate_mesh_in_python_with_gmsh';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Generate MESH and INCON files" href="2_generate_mesh_and_incon_files.html" />
    <link rel="prev" title="CO2 leakage along a fault" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/logo-light.png" class="logo__image only-light" alt="toughio 1.15.0 documentation - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="toughio 1.15.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tough3/index.html">
                        TOUGH3
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tough3/index.html">
                        TOUGH3
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">CO<sub>2</sub> leakage along a fault</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Generate mesh in Python with Gmsh</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_generate_mesh_and_incon_files.html">Generate MESH and INCON files</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_generate_model_parameters_input_file.html">Generate model parameters input file</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_import_and_visualize_simulation_outputs_in_pyvista.html">Import and visualize simulation outputs in PyVista</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../heat_pipe_in_cylindrical_geometry/index.html">Heat pipe in cylindrical geometry (EOS3)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../heat_pipe_in_cylindrical_geometry/1_preprocessing.html">Generate input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../heat_pipe_in_cylindrical_geometry/2_postprocessing.html">Plot profiles</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">CO<sub>2</sub> leakage along a fault</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Generate...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-co2-leakage-along-a-fault-1-generate-mesh-in-python-with-gmsh-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="generate-mesh-in-python-with-gmsh">
<span id="sphx-glr-examples-co2-leakage-along-a-fault-1-generate-mesh-in-python-with-gmsh-py"></span><h1>Generate mesh in Python with Gmsh<a class="headerlink" href="#generate-mesh-in-python-with-gmsh" title="Link to this heading">#</a></h1>
<p>This examples describes how to generate a mesh using Gmsh in Python. It requires <code class="xref py py-mod docutils literal notranslate"><span class="pre">pygmsh</span></code> v7 to be installed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pygmsh<span class="w"> </span>--user
</pre></div>
</div>
<p>The mesh can also be generated from scratch directly in Gmsh either using its GUI and/or its internal scripting language.</p>
<p>Note that <code class="xref py py-mod docutils literal notranslate"><span class="pre">toughio</span></code> is not required at this preliminary stage of the pre-processing. This example only intends to show how the mesh used in this sample problem has been generated. The user is free to use any meshing software as long as the mesh format is supported by <code class="xref py py-mod docutils literal notranslate"><span class="pre">toughio</span></code> (through <code class="xref py py-mod docutils literal notranslate"><span class="pre">meshio</span></code>).</p>
<p>First, we import <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="xref py py-mod docutils literal notranslate"><span class="pre">pygmsh</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pygmsh</span>
</pre></div>
</div>
<p>We can define a bunch of useful variables such as the characteristic length or some parameters to characterize the model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lc</span> <span class="o">=</span> <span class="mf">100.0</span>                       <span class="c1"># Characteristic length of mesh</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2000.0</span>         <span class="c1"># X axis boundaries</span>
<span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">500.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2500.0</span>     <span class="c1"># Z axis boundaries</span>

<span class="n">inj_z</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1500.0</span>                  <span class="c1"># Depth of injection</span>
<span class="n">flt_offset</span> <span class="o">=</span> <span class="mf">50.0</span>                <span class="c1"># Offset of fault</span>
<span class="n">flt_thick</span> <span class="o">=</span> <span class="mf">10.0</span>                 <span class="c1"># Thickness of fault</span>
<span class="n">tana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mf">80.0</span><span class="p">))</span>  <span class="c1"># Tangeant of dipping angle of fault</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">500.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">flt_thick</span>   <span class="c1"># Distance from injection point (0.0, -1500.0) to left wall of fault</span>

<span class="n">bnd_thick</span> <span class="o">=</span> <span class="mf">10.0</span>                 <span class="c1"># Thickness of boundary elements</span>
</pre></div>
</div>
<p>We start by defining the geometrical entity representing the fault.
The fault is represented as a finite-thickness element that intersects all the layers of the model.
To ensure conformity of the final mesh, each wall of the fault is represented by a segmented line where the positions of the nodes correspond to the intersections of the hanging (left) and foot (right) walls with the different layers.
Note that the foot wall is inverted so that the fault entity forms a closed rectangular loop.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">depths</span> <span class="o">=</span> <span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span><span class="p">,</span> <span class="n">zmax</span><span class="p">]</span>
<span class="n">fault_left</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">depths</span><span class="p">]</span>

<span class="n">depths</span> <span class="o">=</span> <span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="n">zmax</span><span class="p">]</span>
<span class="n">fault_right</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">depths</span><span class="p">]</span>

<span class="n">fault_pts</span> <span class="o">=</span> <span class="n">fault_left</span> <span class="o">+</span> <span class="n">fault_right</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Now, we define the aquifer located at the left side of the fault.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">cenaq_left_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1450.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1550.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">capro_top_left_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1300.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1450.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">capro_bot_left_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1550.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1700.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">uppaq_left_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmin</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1300.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">basaq_left_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1700.0</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Likewise, we also define the aquifer located at the right side of the fault.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">cenaq_right_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1450.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1550.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">capro_top_right_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1300.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1450.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">capro_bot_right_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1550.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1700.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">uppaq_right_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmin</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1300.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">basaq_right_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1700.0</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmax</span><span class="o">-</span><span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Then, we define the boundary elements.
In this sample problem, a no-flow boundary condition is imposed on the left side of the model (default in TOUGH), and Dirichlet boundary conditions are imposed elsewhere.
Thus, physical boundary elements must be defined at the top, right and bottom sides of the model.
Similarly to the fault entity, boundary entities are segmented to ensure conformity of the final mesh.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">bound_right_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1700.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1550.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1450.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1300.0</span> <span class="o">+</span> <span class="n">flt_offset</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">bound_top_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmin</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmin</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="n">zmin</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmin</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="n">zmin</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmin</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="n">zmin</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">zmin</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">bound_bot_pts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">inj_z</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">-</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">-</span> <span class="n">bnd_thick</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span> <span class="o">+</span> <span class="n">flt_thick</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">-</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">dist</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">inj_z</span> <span class="o">-</span> <span class="n">bnd_thick</span><span class="p">)</span> <span class="o">/</span> <span class="n">tana</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">-</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">-</span> <span class="n">bnd_thick</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Once all the points have been created, we can now generate the geometry, assign rock types/materials as Gmsh physical properties, and generate the mesh.
To refine the mesh in the injection zone, the characteristic length of each layer entity is increased the farther we get from the injection point.
Note that layers are defined such that their characteristic lengths are increasing. This is because Gmsh keeps the first node defined in the geometry in case it detects duplicated nodes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pygmsh</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">Geometry</span><span class="p">()</span> <span class="k">as</span> <span class="n">geo</span><span class="p">:</span>
    <span class="c1"># Define polygons</span>
    <span class="n">fault</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">fault_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">cenaq_left</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">cenaq_left_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">capro_top_left</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">capro_top_left_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">capro_bot_left</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">capro_bot_left_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">uppaq_left</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">uppaq_left_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">basaq_left</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">basaq_left_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">cenaq_right</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">cenaq_right_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">capro_top_right</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">capro_top_right_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">capro_bot_right</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">capro_bot_right_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">uppaq_right</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">uppaq_right_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">basaq_right</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">basaq_right_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">lc</span><span class="p">)</span>
    <span class="n">bound_right</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">bound_right_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span>
    <span class="n">bound_top</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">bound_top_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span>
    <span class="n">bound_bot</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">bound_bot_pts</span><span class="p">,</span> <span class="n">mesh_size</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span>

    <span class="c1"># Define materials</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">add_physical</span><span class="p">([</span><span class="n">uppaq_left</span><span class="p">,</span> <span class="n">uppaq_right</span><span class="p">],</span> <span class="s2">&quot;UPPAQ&quot;</span><span class="p">)</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">add_physical</span><span class="p">([</span><span class="n">capro_top_left</span><span class="p">,</span> <span class="n">capro_bot_left</span><span class="p">,</span> <span class="n">capro_top_right</span><span class="p">,</span> <span class="n">capro_bot_right</span><span class="p">],</span> <span class="s2">&quot;CAPRO&quot;</span><span class="p">)</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">add_physical</span><span class="p">([</span><span class="n">cenaq_left</span><span class="p">,</span> <span class="n">cenaq_right</span><span class="p">],</span> <span class="s2">&quot;CENAQ&quot;</span><span class="p">)</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">add_physical</span><span class="p">([</span><span class="n">basaq_left</span><span class="p">,</span> <span class="n">basaq_right</span><span class="p">],</span> <span class="s2">&quot;BASAQ&quot;</span><span class="p">)</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">add_physical</span><span class="p">(</span><span class="n">fault</span><span class="p">,</span> <span class="s2">&quot;FAULT&quot;</span><span class="p">)</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">add_physical</span><span class="p">([</span><span class="n">bound_right</span><span class="p">,</span> <span class="n">bound_top</span><span class="p">,</span> <span class="n">bound_bot</span><span class="p">],</span> <span class="s2">&quot;BOUND&quot;</span><span class="p">)</span>

    <span class="c1"># Remove duplicate entities</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">removeAllDuplicates</span><span class="p">()</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">generate_mesh</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Convert cell sets to material</span>
    <span class="n">cell_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span>
    <span class="n">field_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">cell_sets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">field_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="n">cell_data</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">vv</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s2">&quot;material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_data</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">field_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">field_data</span><span class="p">)</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">cell_sets</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Remove lower dimension entities</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;triangle&quot;</span><span class="p">]</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="p">[</span><span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">cell_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cell_data</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="c1"># Export the mesh for post-processing</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;mesh.vtu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The generated mesh can be visualized in Python with <code class="xref py py-mod docutils literal notranslate"><span class="pre">pyvista</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyvista</span>
<span class="n">pyvista</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">pyvista</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span>
    <span class="n">mesh</span><span class="o">=</span><span class="n">pyvista</span><span class="o">.</span><span class="n">from_meshio</span><span class="p">(</span><span class="n">mesh</span><span class="p">),</span>
    <span class="n">scalar_bar_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Materials&quot;</span><span class="p">},</span>
    <span class="n">show_scalar_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">view_xy</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_1_generate_mesh_in_python_with_gmsh_001.png" srcset="../../_images/sphx_glr_1_generate_mesh_in_python_with_gmsh_001.png" alt="1 generate mesh in python with gmsh" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 2.159 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-co2-leakage-along-a-fault-1-generate-mesh-in-python-with-gmsh-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/63dce8a29a4f6d13d94e96ddab9a2160/1_generate_mesh_in_python_with_gmsh.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">1_generate_mesh_in_python_with_gmsh.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/63e6fc27943783755535e4c8d94b8bc3/1_generate_mesh_in_python_with_gmsh.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">1_generate_mesh_in_python_with_gmsh.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">CO<sub>2</sub> leakage along a fault</p>
      </div>
    </a>
    <a class="right-next"
       href="2_generate_mesh_and_incon_files.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Generate MESH and INCON files</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/examples/co2_leakage_along_a_fault/1_generate_mesh_in_python_with_gmsh.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Keurfon Luu.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>