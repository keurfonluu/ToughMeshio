
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Preparation of Input Data &#8212; toughio 1.15.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=8fbebee6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=70d5d4a5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tough3/guide/preparation_of_input_data';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Output from TOUGH3" href="output_from_tough3.html" />
    <link rel="prev" title="Initial and Boundary Conditions" href="initial_and_boundary_conditions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/logo-light.png" class="logo__image only-light" alt="toughio 1.15.0 documentation - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="toughio 1.15.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        TOUGH3
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        TOUGH3
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../install/index.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/linux.html">Installation on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/windows.html">Installation on Windows</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">User Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="governing_equations.html">Governing Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="numerical_methods.html">Numerical Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="initial_and_boundary_conditions.html">Initial and Boundary Conditions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Preparation of Input Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="output_from_tough3.html">Output from TOUGH3</a></li>
<li class="toctree-l2"><a class="reference internal" href="relative_permeability_functions.html">Relative Permeability Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="capillary_pressure_functions.html">Capillary Pressure Functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../eos/index.html">EOS</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos1.html">EOS1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos2.html">EOS2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos3.html">EOS3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos4.html">EOS4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos5.html">EOS5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos7.html">EOS7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos7r.html">EOS7R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos8.html">EOS8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eos9.html">EOS9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/ewasg.html">EWASG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eos/eco2n.html">ECO2N</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">TOUGH3</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Preparation...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="preparation-of-input-data">
<span id="id1"></span><h1>Preparation of Input Data<a class="headerlink" href="#preparation-of-input-data" title="Link to this heading">#</a></h1>
<p>To characterize a flow system, users need to prepare input data, including hydrogeologic and thermal parameters and constitutive relations of the permeable medium (absolute and relative permeability, porosity, capillary pressure, heat conductivity, etc.), thermophysical properties of the
fluids (mostly provided internally), initial and boundary conditions of the flow system, and sinks and sources.
In addition, TOUGH3 requires specification of space-discretized geometry, and various program options, computational parameters, and time-stepping information.
Here we summarize the basic conventions adopted for TOUGH3 input data (Section <a class="reference internal" href="#tough3-input-data"><span class="std std-ref">TOUGH3 Input Data</span></a>), and provide a detailed explanation of input data formats (Section <a class="reference internal" href="#tough3-input-format"><span class="std std-ref">TOUGH3 Input Format</span></a>); the summary and input formats for internal grid generation through the MESHMaker module are explained in Sections <a class="reference internal" href="#geometry-data"><span class="std std-ref">Geometry Data</span></a> and <a class="reference internal" href="#input-formats-for-meshmaker"><span class="std std-ref">Input Formats for MESHMAKER</span></a>, respectively.
Some of the EOS modules have specialized input requirements (discussed in the addenda for those modules).
The TMVOC, ECO2N, and ECO2M modules have special options and input requirements, which are explained in separate reports (TMVOC: Pruess and Battistelli, 2002; ECO2N: Pruess, 2005, Pan et al., 2015; ECO2M: Pruess, 2013).</p>
<section id="tough3-input-data">
<span id="id2"></span><h2>TOUGH3 Input Data<a class="headerlink" href="#tough3-input-data" title="Link to this heading">#</a></h2>
<p>Input can be provided to TOUGH3 in a flexible manner by means of one or several ASCII data files.
All TOUGH3 input is in fixed format (a few exceptions, such as data blocks <strong>GENER</strong> and <strong>TIMBC</strong>) and standard metric (SI) units, such as meters, seconds, kilograms, ˚C, and the corresponding derived units, such as Newtons, Joules, and Pascal = N/m<sup>2</sup> for pressure.</p>
<p>In the standard TOUGH3 input file data are organized in blocks which are defined by five-character keywords typed in columns 1-5; see <a class="reference internal" href="#tab-3"><span class="std std-numref">Table 2</span></a>.
The first record must be a problem title of up to 80 characters.
The last record usually is ENDCY; alternatively, ENDFI may be used if no flow simulation is to be carried out (useful for mesh generation).
Data records beyond <strong>ENDCY</strong> (or <strong>ENDFI</strong>) will be ignored.
Some data blocks, such as those specifying reservoir domains (ROCKS), volume elements (<strong>ELEME</strong>), connections (<strong>CONNE</strong>), sinks/sources (<strong>GENER</strong>), and initial conditions (<strong>INDOM</strong> and <strong>INCON</strong>), have a variable number of records, while others have a fixed number of records.
The end of variable-length data blocks is indicated by a blank record.
The data blocks can be provided in arbitrary order; exceptions are (1) the first line must be the title line, (2) <strong>ELEME</strong>, if present, must precede <strong>CONNE</strong>, (3) <strong>START</strong>, if present, must be specified before <strong>INCON</strong>, and (4) <strong>MULTI</strong> must be specified before <strong>PARAM</strong>, <strong>INDOM</strong>, <strong>INCON</strong> (only if <span class="math notranslate nohighlight">\(NKIN \ne NK\)</span>), and <strong>OUTPU</strong>.
The blocks <strong>ELEME</strong> and <strong>CONNE</strong> must either be both provided through the input file, or must both be absent, in which case alternative means for specifying geometry data will be employed (see Section <a class="reference internal" href="#geometry-data"><span class="std std-ref">Geometry Data</span></a>).
If <strong>START</strong> is present, the block <strong>INCON</strong> can be incomplete, with elements in arbitrary order, or can be absent altogether.
Elements for which no initial conditions are specified in <strong>INCON</strong> will then be assigned domain-specific initial conditions from block <strong>INDOM</strong>, if present, or will be assigned default initial conditions given in block <strong>PARAM</strong>, along with default porosities given in <strong>ROCKS</strong>.
If <strong>START</strong> is not present, <strong>INCON</strong> must contain information for all elements, in exactly the same order as they are listed in block <strong>ELEME</strong> (note that initial conditions will be assigned to elements according to their order, not the element name).</p>
<table class="table table-center" id="tab-3">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">TOUGH3 input data blocks.</span><a class="headerlink" href="#tab-3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 16.7%" />
<col style="width: 83.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>TITLE</strong></p></td>
<td><p>first record, single line with a title for the simulation problem</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MESHM</strong></p></td>
<td><p>parameters for internal grid generation through MESHMaker</p></td>
</tr>
<tr class="row-even"><td><p><strong>ROCKS</strong></p></td>
<td><p>hydrogeologic parameters for various reservoir domains</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MULTI</strong></p></td>
<td><p>specifies number of fluid components and balance equations per grid block</p></td>
</tr>
<tr class="row-even"><td><p><strong>SELEC</strong></p></td>
<td><p>used with certain EOS-modules to supply thermophysical property data</p></td>
</tr>
<tr class="row-odd"><td><p><strong>START</strong></p></td>
<td><p>one data record for more flexible initialization</p></td>
</tr>
<tr class="row-even"><td><p><strong>PARAM</strong></p></td>
<td><p>computational parameters; time stepping and convergence parameters; program options; default initial conditions</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MOMOP</strong></p></td>
<td><p>more program options</p></td>
</tr>
<tr class="row-even"><td><p><strong>SOLVR</strong></p></td>
<td><p>parameters for linear equation solver</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DIFFU</strong></p></td>
<td><p>diffusivities of mass components</p></td>
</tr>
<tr class="row-even"><td><p><strong>FOFT</strong></p></td>
<td><p>specifies grid blocks for which time series data are desired</p></td>
</tr>
<tr class="row-odd"><td><p><strong>COFT</strong></p></td>
<td><p>specifies connections for which time series data are desired</p></td>
</tr>
<tr class="row-even"><td><p><strong>GOFT</strong></p></td>
<td><p>specifies sinks/sources for which time series data are desired</p></td>
</tr>
<tr class="row-odd"><td><p><strong>RPCAP</strong></p></td>
<td><p>parameters for relative permeability and capillary pressure functions</p></td>
</tr>
<tr class="row-even"><td><p><strong>HYSTE</strong></p></td>
<td><p>parameters for hysteretic characteristic curves; required only if non-default values of parameters are used</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TIMES</strong></p></td>
<td><p>specification of times for generating printout</p></td>
</tr>
<tr class="row-even"><td><p><strong>ELEME*</strong></p></td>
<td><p>list of grid blocks (volume elements)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>CONNE*</strong></p></td>
<td><p>list of flow connections between grid blocks</p></td>
</tr>
<tr class="row-even"><td><p><strong>GENER*</strong></p></td>
<td><p>list of mass or heat sinks and sources</p></td>
</tr>
<tr class="row-odd"><td><p><strong>INDOM</strong></p></td>
<td><p>list of initial conditions for specific reservoir domains</p></td>
</tr>
<tr class="row-even"><td><p><strong>INCON*</strong></p></td>
<td><p>list of initial conditions for specific grid blocks</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TIMBC</strong></p></td>
<td><p>specifies time-dependent Dirichlet boundary conditions</p></td>
</tr>
<tr class="row-even"><td><p><strong>OUTPU</strong></p></td>
<td><p>specifies variables/parameters for printout</p></td>
</tr>
<tr class="row-odd"><td><p><strong>ENDCY</strong></p></td>
<td><p>last record to close the TOUGH3 input file and initiate the simulation</p></td>
</tr>
<tr class="row-even"><td><p><strong>ENDFI</strong></p></td>
<td><p>alternative to <strong>ENDCY</strong> for closing a TOUGH3 input file; will cause flow simulation to be skipped; useful if only mesh generation is desired</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>* These blocks can be provided on separate disk files, in which case they would be omitted from the <em>INPUT</em> file.</p>
</div>
<p>Between data blocks, an arbitrary number of records with arbitrary data may be present that do not begin with any of the TOUGH3 keywords.
This is useful for inserting comments about problem specifications directly into the input file.
TOUGH3 will gather all these comments and will print the first 50 such records in the output file.</p>
<p>Much of the data handling in TOUGH3 is accomplished by means of disk files, which are written in a format of 80 characters per record, so that they can be edited and modified with any text editor.</p>
<p><a class="reference internal" href="#tab-4"><span class="std std-numref">Table 3</span></a> summarizes the disk files other than (default) INPUT and OUTPUT used in TOUGH3.
The initialization of the arrays for geometry, generation, and initial condition data is always made from the disk files <em>MESH</em> (or <em>MINC</em>), <em>GENER</em>, and <em>INCON</em>.
A user can either provide these files at execution time, or they can be written from TOUGH3 input data during the initialization phase of the program.
During this initialization phase, two binary files <em>MESHA</em> and <em>MESHB</em> are created from the disk file <em>MESH</em>.
If <em>MESHA</em> and <em>MESHB</em> exist in the working folder, the code will ignore the <em>MESH</em> file and the <strong>ELEME</strong> and <strong>CONNE</strong> blocks in the input file, and read geometric information directly from these two files, which will reduce the memory requirement for the master processor and enhance I/O efficiency.
If the mesh is changed, <em>MESHA</em> and <em>MESHB</em> must be deleted from the working folder to make the changes take effect.
If no data blocks <strong>GENER</strong> and <strong>INCON</strong> are provided in the input file, and if no disk files <em>GENER</em> and <em>INCON</em> are present, defaults will take effect (no generation; domain-specific initial conditions from block <strong>INDOM</strong>, or defaults from block <strong>PARAM</strong>).
If a user intends to use these defaults, the user has to make sure that at execution time no disk files <em>INCON</em> or <em>GENER</em> are present from a previous run (or perhaps from a different problem).
A safe way to use default <strong>GENER</strong> and <strong>INCON</strong> is to specify “dummy” data blocks in the input file, consisting of one record with <strong>GENER</strong> or <strong>INCON</strong>, followed by a blank record.</p>
<p>The format of data blocks <strong>ELEME</strong>, <strong>CONNE</strong>, <strong>GENER</strong>, and <strong>INCON</strong> is basically the same when these data are provided as disk files as when they are given as part of the input file.
However, specification of these data through the input file rather than as disk files offers some added conveniences, which are useful when a new simulation problem is initiated.
For example, a sequence of identical items (volume elements, connections, sinks or sources) can be specified through a single data record.
Also, indices used internally for cross-referencing elements, connections, and sources will be generated internally by TOUGH3 rather than having them provided by the user.
<em>MESH</em>, <em>GENER</em>, and <em>INCON</em> disk files written by TOUGH3 can be merged into an input file without changes, keeping the cross-referencing information.</p>
<table class="table table-center" id="tab-4">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">TOUGH3 disk files.</span><a class="headerlink" href="#tab-4" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 16.7%" />
<col style="width: 83.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>File</p></th>
<th class="head"><p>Use</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>MESH</em></p></td>
<td><p>written in subroutine INPUT from <strong>ELEME</strong> and <strong>CONNE</strong> data, or in module MESHMaker from mesh specification data; read in <em>RFILE</em> to initialize all geometry data arrays used to define the discretized flow problem</p></td>
</tr>
<tr class="row-odd"><td><p><em>GENER</em></p></td>
<td><p>written in subroutine <em>INPUT</em> from <strong>GENER</strong> data; read in <em>RFILE</em> to define nature, strength, and time-dependence of sinks and sources</p></td>
</tr>
<tr class="row-even"><td><p><em>INCON</em></p></td>
<td><p>written in subroutine <em>INPUT</em> from <strong>INCON</strong> data; read in <em>RFILE</em> to provide a complete specification of initial thermodynamic conditions</p></td>
</tr>
<tr class="row-odd"><td><p><em>SAVE</em></p></td>
<td><p>written in subroutine <em>WRIFI</em> to record thermodynamic conditions at the end of a TOUGH3 simulation run; compatible with formats of file or data block <strong>INCON</strong> for initializing a continuation run</p></td>
</tr>
<tr class="row-even"><td><p><em>MINC</em></p></td>
<td><p>written in module MESHMaker with MESH-compatible specifications, to provide all geometry data for a fractured-porous medium mesh (double porosity, dual permeability, multiple interacting continua); read (optionally) in subroutine <em>RFILE</em> to initialize geometry data for a fractured-porous system</p></td>
</tr>
<tr class="row-odd"><td><p><em>TABLE</em></p></td>
<td><p>written in subroutine <em>CYCIT</em> to record coefficients of semi-analytical linear heat exchange with confining beds at the end of a TOUGH3 simulation run; read (optionally) in subroutine <em>QLOSS</em> to initialize heat exchange coefficients in a continuation run</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tough3-input-format">
<span id="id3"></span><h2>TOUGH3 Input Format<a class="headerlink" href="#tough3-input-format" title="Link to this heading">#</a></h2>
<p>Here we cover the common input data for all EOS modules of TOUGH3.
Additional EOS-specific input data are discussed in the addendum for each EOS module.
The format described is for the default five-character element names.</p>
<section id="title">
<h3>TITLE<a class="headerlink" href="#title" title="Link to this heading">#</a></h3>
<p>This is the first record of the input file, containing a header of up to 80 characters, to be printed on output.
This can be used to identify a problem. If no title is desired, leave this record blank.</p>
</section>
<section id="rocks">
<h3>ROCKS<a class="headerlink" href="#rocks" title="Link to this heading">#</a></h3>
<p>Introduces material parameters for different reservoir domains.</p>
<table class="table table-center" id="tab-rocks-1">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Record <strong>ROCKS.1</strong>.</span><a class="headerlink" href="#tab-rocks-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MAT</span></code></p></td>
<td><p>A5</p></td>
<td><p>material name (rock type).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NAD</span></code></p></td>
<td><p>I5</p></td>
<td><div class="line-block">
<div class="line">if zero or negative, defaults will take effect for a number of parameters (see below):</div>
<div class="line">≥ 1: will read another data record to override defaults.</div>
<div class="line">≥ 2: will read two more records with domain-specific parameters for relative permeability and capillary pressure functions.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DROK</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>rock grain density (kg/m<sup>3`</sup>). If <code class="docutils literal notranslate"><span class="pre">DROK</span></code> is set to a very large value (typically 1.0E50), a constant temperature boundary condition can be specified (but variable pressure/saturation).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">POR</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>default porosity (void fraction) for all elements belonging to domain <code class="docutils literal notranslate"><span class="pre">MAT</span></code> for which no other porosity has been specified in block <strong>INCON</strong>. Option <strong>START</strong> is necessary for using default porosity.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PER(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, 3 absolute permeabilities along the three principal axes, as specified by <code class="docutils literal notranslate"><span class="pre">ISOT</span></code> in block <strong>CONNE</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">CWET</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>formation heat conductivity under fully liquid-saturated conditions (W/m ˚C).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SPHT</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>rock grain specific heat (J/kg ˚C). Domains with <code class="docutils literal notranslate"><span class="pre">SPHT</span></code> &gt; 10<sup>4</sup> J/kg ˚C will not be included in global material balances. This provision is useful for boundary nodes, which are given very large volumes so that their thermo-dynamic state remains constant. Because of the large volume, inclusion of such nodes in global material balances would make the balances useless.</p></td>
</tr>
</tbody>
</table>
<p>When a (dummy) domain named “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” is specified, the absolute permeabilities specified in <code class="docutils literal notranslate"><span class="pre">PER(I)</span></code> are modified by the block-by-block permeability modifiers (PM) according to:</p>
<div class="math notranslate nohighlight" id="equation-eq-48">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-48" title="Link to this equation">#</a></span>\[k_n \rightarrow k_n^{'} = k_n \cdot \zeta_n\]</div>
<p>Here, <span class="math notranslate nohighlight">\(k_n\)</span> is the absolute (“reference”) permeability of grid block <span class="math notranslate nohighlight">\(n\)</span>, as specified in data block <strong>ROCKS</strong> for the domain to which that grid block belongs, <span class="math notranslate nohighlight">\(k_n^{'}\)</span> is the modified permeability, and <span class="math notranslate nohighlight">\(\zeta_n\)</span> is the PM coefficient.
When PM is in effect, the strength of capillary pressure will be automatically scaled according to (<span id="id4"><a class="reference internal" href="../references.html#id48" title="Leverett, M. (1941). Capillary behavior in porous solids. Transactions of the AIME, 142(01), 152–169.">Leverett, 1941</a></span>)</p>
<div class="math notranslate nohighlight" id="equation-eq-49">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-49" title="Link to this equation">#</a></span>\[P_{cap, n} \rightarrow P_{cap, n}^{'} = \frac{P_{cap, n}}{\sqrt{\zeta_n}}\]</div>
<p>No grid blocks should be assigned to this domain; the presence of domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” simply serves as a flag to put permeability modification into effect.
Random (spatially uncorrelated) PM data can be internally generated in TOUGH3. Alternatively, externally defined permeability modifiers may be provided as part of the geometry data (PMX) in block <strong>ELEME</strong>. Available PM options are:</p>
<ol class="arabic simple">
<li><p>Externally supplied: <span class="math notranslate nohighlight">\(\zeta_n = PMX - PER(2)\)</span></p></li>
<li><p>“Linear”: <span class="math notranslate nohighlight">\(\zeta_n = PER(1) \times s - PER(2)\)</span></p></li>
<li><p>“Logarithmic”: <span class="math notranslate nohighlight">\(\zeta_n = \exp \left( - PER(1) \times s \right) - PER(2)\)</span></p></li>
</ol>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is a random number between 0 and 1.</p>
<p>Data provided in domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” are used to select the following options.</p>
<table class="table table-center" id="tab-seed">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>”.</span><a class="headerlink" href="#tab-seed" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DROK</span></code></p></td>
<td><p>E10.4</p></td>
<td><div class="line-block">
<div class="line">random number seed for internal generation of “linear” permeability modifiers:</div>
<div class="line">= 0: (default) no internal generation of “linear” permeability modifiers.</div>
<div class="line">&gt; 0: perform “linear” permeability modification; random modifiers are generated internally with <code class="docutils literal notranslate"><span class="pre">DROK</span></code> as seed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">POR</span></code></p></td>
<td><p>E10.4</p></td>
<td><div class="line-block">
<div class="line">random number seed for internal generation of “logarithmic” permeability modifiers:</div>
<div class="line">= 0:  (default) no internal generation of “logarithmic” permeability modifiers.</div>
<div class="line">&gt; 0: perform “logarithmic” permeability modification; random modifiers are generated internally with <code class="docutils literal notranslate"><span class="pre">POR</span></code> as seed.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PER(1)</span></code></p></td>
<td><p>E10.4</p></td>
<td><div class="line-block">
<div class="line">scale factor (optional) for internally generated permeability modifiers:</div>
<div class="line">= 0: (defaults to <code class="docutils literal notranslate"><span class="pre">PER(1)</span></code> = 1): permeability modifiers are generated as random numbers in the interval (0, 1).</div>
<div class="line">&gt; 0: permeability modifiers are generated as random numbers in the interval (0, <code class="docutils literal notranslate"><span class="pre">PER(1)</span></code>).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PER(2)</span></code></p></td>
<td><p>E10.4</p></td>
<td><div class="line-block">
<div class="line">shift (optional) for internal or external permeability modifiers:</div>
<div class="line">= 0: (default) no shift is applied to permeability modifiers.</div>
<div class="line">&gt; 0: permeability modifiers are shifted according to <span class="math notranslate nohighlight">\(\zeta_n^{'} = \zeta_n - PER(2)\)</span>. All <span class="math notranslate nohighlight">\(\zeta_n^{'} \lt 0\)</span> are set equal to zero.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>If both <code class="docutils literal notranslate"><span class="pre">DROK</span></code> and <code class="docutils literal notranslate"><span class="pre">POR</span></code> are specified as non-zero, <code class="docutils literal notranslate"><span class="pre">DROK</span></code> takes precedence.
And if both <code class="docutils literal notranslate"><span class="pre">DROK</span></code> and <code class="docutils literal notranslate"><span class="pre">POR</span></code> are zero, permeability modifiers as supplied through <strong>ELEME</strong> data will be used.
Note that the domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” is not required in TOUGH3 if externally defined permeability modifiers in block <strong>ELEME</strong> are used without any shift.</p>
<table class="table table-center" id="tab-rocks-1-1">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Record <strong>ROCKS.1.1</strong> (optional, <code class="docutils literal notranslate"><span class="pre">NAD</span></code> ≥ 1 only).</span><a class="headerlink" href="#tab-rocks-1-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">COM</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>pore compressiblity (Pa<sup>-1</sup>), <span class="math notranslate nohighlight">\(\frac{1}{\phi} \left( \frac{\partial \phi}{\partial P} \right)_T\)</span>, (default is 0).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">EXPAN</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>pore expansivity (1/ ˚C), <span class="math notranslate nohighlight">\(\frac{1}{\phi} \left( \frac{\partial \phi}{\partial T} \right)_P\)</span>, (default is 0).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CDRY</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>formation heat conductivity under desaturated conditions (W/m ˚C), (default is <code class="docutils literal notranslate"><span class="pre">CWET</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TORTX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>tortuosity factor for binary diffusion. If <code class="docutils literal notranslate"><span class="pre">TORTX</span></code> = 0, a porosity and saturation-dependent tortuosity will be calculated internally from the <span id="id5"><a class="reference internal" href="../references.html#id54" title="Millington, R., &amp; Quirk, J. (1961). Permeability of porous solids. Transactions of the Faraday Society, 57, 1200–1207.">Millington &amp; Quirk, 1961</a></span> model, Eq. (12). When diffusivities, FDDIAGin data block <strong>DIFFU</strong>, are specified as negative numbers, <span class="math notranslate nohighlight">\(\tau_0 \tau_{\beta} = S_{\beta}\)</span> will be used.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GK</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>Klinkenberg parameter b (Pa<sup>-1`</sup>) for enhancing gas phase permeability according to the relationship <span class="math notranslate nohighlight">\(k_{gas} = k \left( 1 + \frac{b}{P} \right)\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">XKD3</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>Distribution coefficient for parent radionuclide, Component 3, in the aqueous phase, m<sup>3`</sup> kg<sup>-1</sup> (EOS7R only).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">XKD4</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>Distribution coefficient for daughter radionuclide, Component 4, in the aqueous phase, m<sup>3`</sup> kg<sup>-1</sup> (EOS7R only).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-rocks-1-2">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Record <strong>ROCKS.1.2</strong> (optional, <code class="docutils literal notranslate"><span class="pre">NAD</span></code> ≥ 2 only).</span><a class="headerlink" href="#tab-rocks-1-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IRP</span></code></p></td>
<td><p>I5</p></td>
<td><p>integer parameter to choose type of relative permeability function.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, …, 7 parameters for relative permeability function.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-rocks-1-2-1">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">Record <strong>ROCKS.1.2.1</strong> (optional, <code class="docutils literal notranslate"><span class="pre">IRP</span></code> = 12 only).</span><a class="headerlink" href="#tab-rocks-1-2-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 8, …, 10 parameters for relative permeability function.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-rocks-1-3">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">Record <strong>ROCKS.1.3</strong> (optional, <code class="docutils literal notranslate"><span class="pre">NAD</span></code> ≥ 2 only).</span><a class="headerlink" href="#tab-rocks-1-3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ICP</span></code></p></td>
<td><p>I5</p></td>
<td><p>integer parameter to choose type of capillary pressure function.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, …, 7 parameters for capillary pressure function.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-rocks-1-3-1">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Record <strong>ROCKS.1.3.1</strong> (optional, <code class="docutils literal notranslate"><span class="pre">ICP</span></code> = 12 only).</span><a class="headerlink" href="#tab-rocks-1-3-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 8, …, 13 parameters for capillary pressure function.</p></td>
</tr>
</tbody>
</table>
<p>Repeat records 1, 1.1, 1.2, 1.2.1., 1.3, and 1.3.1 for different reservoir domains.</p>
<p>A blank record closes the <strong>ROCKS</strong> data block.</p>
</section>
<section id="multi">
<h3>MULTI<a class="headerlink" href="#multi" title="Link to this heading">#</a></h3>
<p>Permits the user to select the number and nature of balance equations that will be solved.
For most EOS modules this data block is not needed, as default values are provided internally.
Available parameter choices are different for different EOS modules (see the addendum of the EOS module of interest).</p>
<table class="table table-center" id="tab-multi-1">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">Record <strong>MULTI.1</strong>.</span><a class="headerlink" href="#tab-multi-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NK</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of mass components.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NEQ</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of balance equations per grid block. Usually we have <code class="docutils literal notranslate"><span class="pre">NEQ</span></code> = <code class="docutils literal notranslate"><span class="pre">NK</span></code> + 1, for solving <code class="docutils literal notranslate"><span class="pre">NK</span></code> mass and one energy balance equation. Some EOS modules allow the option <code class="docutils literal notranslate"><span class="pre">NEQ</span></code> = <code class="docutils literal notranslate"><span class="pre">NK</span></code>, in which case only <code class="docutils literal notranslate"><span class="pre">NK</span></code> mass balances and no energy equation will be solved.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NPH</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of phases that can be present (2 for most EOS modules).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NB</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of secondary parameters in the PAR-array other than component mass fractions. Available options include <code class="docutils literal notranslate"><span class="pre">NB</span></code> = 6 (no diffusion) and <code class="docutils literal notranslate"><span class="pre">NB</span></code> = 8 (include diffusion).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NKIN</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of mass components in <strong>INCON</strong> data (default is <code class="docutils literal notranslate"><span class="pre">NKIN</span></code> = <code class="docutils literal notranslate"><span class="pre">NK</span></code>). This parameter can be used, for example, to initialize an EOS7R simulation (<code class="docutils literal notranslate"><span class="pre">NK</span></code> = 4 or 5) from data generated by EOS7 (<code class="docutils literal notranslate"><span class="pre">NK</span></code> = 2 or 3). If a value other than the default is to be used, then data block <strong>MULTI</strong> must appear before any initial conditions in data blocks <strong>PARAM</strong>, <strong>INDOM</strong>, or <strong>INCON</strong>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="start-optional">
<h3>START (optional)<a class="headerlink" href="#start-optional" title="Link to this heading">#</a></h3>
<p>A record with <strong>START</strong> typed in columns 1-5 allows a more flexible initialization.
More specifically, when <strong>START</strong> is present, <strong>INCON</strong> data can be in arbitrary order, and need not be present for all grid blocks (in which case defaults will be used).
Without <strong>START</strong>, there must be a one-to-one correspondence between the data in blocks <strong>ELEME</strong> and <strong>INCON</strong>.</p>
</section>
<section id="param">
<h3>PARAM<a class="headerlink" href="#param" title="Link to this heading">#</a></h3>
<p>Introduces computation parameters, time stepping information, and default initial conditions.</p>
<table class="table table-center" id="tab-param-1">
<caption><span class="caption-number">Table 12 </span><span class="caption-text">Record <strong>PARAM.1</strong>.</span><a class="headerlink" href="#tab-param-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NOITE</span></code></p></td>
<td><p>I2</p></td>
<td><p>specifies the maximum number of Newtonian iterations per time step (default is 8).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">KDATA</span></code></p></td>
<td><p>I2</p></td>
<td><div class="line-block">
<div class="line">specifies amount of printout (default is 1):</div>
<div class="line">0 or 1: print a selection of element variables.</div>
<div class="line">2: in addition, print a selection of connection variables.</div>
<div class="line">3: in addition, print a selection of generation variables.</div>
<div class="line">If the above values for <code class="docutils literal notranslate"><span class="pre">KDATA</span></code> are increased by 10, printout will occur after each Newton-Raphson iteration (not just after convergence).</div>
<div class="line">If negative values are used, printout for the selection of variables will be generated in the file format of TECPLOT. The amount of printout is given by the absolute value of <code class="docutils literal notranslate"><span class="pre">KDATA</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MCYC</span></code></p></td>
<td><p>I4</p></td>
<td><p>maximum number of time steps to be calculated. If a negative value is used, <code class="docutils literal notranslate"><span class="pre">MCYC</span></code> = 2<sup>-MCYC</sup>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MSEC</span></code></p></td>
<td><p>I4</p></td>
<td><p>maximum duration, in CPU seconds, of the simulation (default is infinite).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MCYPR</span></code></p></td>
<td><p>I4</p></td>
<td><p>printout will occur for every multiple of <code class="docutils literal notranslate"><span class="pre">MCYPR</span></code> steps (default is 1). If a negative value is used, <code class="docutils literal notranslate"><span class="pre">MCYPR</span></code> = 2<sup>-MCYPR</sup>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(I)</span></code></p></td>
<td><p>I1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, 24 allows choice of various options, which are documented in printed output from a TOUGH3 run.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(1)</span></code></p></td>
<td><p>I1</p></td>
<td><p>if unequal 0, a short printout for non-convergent iterations will be generated.</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">MOP(2)</span></code></div>
<div class="line">…</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">MOP(6)</span></code></div>
</div>
</td>
<td><p>I1</p></td>
<td><p>generate additional printout in various sub-routines, if set unequal 0. This feature should not be needed in normal applications, but it will be convenient when a user suspects a bug and wishes to examine the inner workings of the code. The amount of printout increases with <code class="docutils literal notranslate"><span class="pre">MOP(I)</span></code> (consult source code listings for details).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(2)</span></code></p></td>
<td><p>I1</p></td>
<td><p><em>CYCIT</em> (main subroutine).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(3)</span></code></p></td>
<td><p>I1</p></td>
<td><p><em>MULTI</em> (flow- and accumulation-terms).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(4)</span></code></p></td>
<td><p>I1</p></td>
<td><p><em>QU</em> (sinks/sources). No longer supported in TOUGH3.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(5)</span></code></p></td>
<td><p>I1</p></td>
<td><p><em>EOS</em> (equation of state).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(6)</span></code></p></td>
<td><p>I1</p></td>
<td><p><em>LINEQ</em> (linear equations). No longer supported in TOUGH3.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(7)</span></code></p></td>
<td><p>I1</p></td>
<td><p>if unequal 0, a printout of input data will be provided.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(8)</span></code></p></td>
<td><p>I1</p></td>
<td><p>if <code class="docutils literal notranslate"><span class="pre">ISOT</span></code> &lt; 0, chooses the option for reducing fracture-matrix interface area.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(9)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">determines the composition of produced fluid with the MASS option (see <strong>GENER</strong>). The relative amounts of phases are determined as follows:</div>
<div class="line">0: according to relative mobilities in the source element.</div>
<div class="line">1: produced source fluid has the same phase composition as the producing element.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(10)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">chooses the interpolation formula for heat conductivity as a function of liquid saturation (<span class="math notranslate nohighlight">\(S_l\)</span>):</div>
<div class="line">0: <span class="math notranslate nohighlight">\(C(S_l) = CDRY + \sqrt{S_l} \left( CWET - CDRY \right)\)</span>.</div>
<div class="line">1: <span class="math notranslate nohighlight">\(C(S_l) = CDRY + S_l \left( CWET - CDRY \right)\)</span>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(11)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">determines evaluation of mobility and permeability at interfaces:</div>
<div class="line">0: mobilities are upstream weighted with <code class="docutils literal notranslate"><span class="pre">WUP</span></code> (see <strong>PARAM.3</strong>), permeability is upstream weighted.</div>
<div class="line">1: mobilities are averaged between adjacent elements, permeability is upstream weighted.</div>
<div class="line">2: mobilities are upstream weighted, permeability is harmonic weighted.</div>
<div class="line">3: mobilities are averaged between adjacent elements, permeability is harmonic weighted.</div>
<div class="line">4: mobility and permeability are both harmonic weighted.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(12)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">determines interpolation procedure for time dependent sink/source data (flow rates and enthalpies):</div>
<div class="line">0: triple linear interpolation; tabular data are used to obtain interpolated rates and enthalpies for the beginning and end of the time step; the average of these values is then used.</div>
<div class="line">1: step function option; rates and enthalpies are taken as averages of the table values corresponding to the beginning and end of the time step.</div>
<div class="line">2: rigorous step rate capability for time dependent generation data. A set of times <span class="math notranslate nohighlight">\(t_i\)</span> and generation rates <span class="math notranslate nohighlight">\(q_i\)</span> provided in data block <strong>GENER</strong> is interpreted to mean that sink/source rates are piecewise constant and change in discontinuous fashion at table points. Specifically, generation is assumed to occur at constant rate <span class="math notranslate nohighlight">\(q_i\)</span> during the time interval <span class="math notranslate nohighlight">\([t_i, t_{i+1})\)</span>, and changes to <span class="math notranslate nohighlight">\(q_{i+1}\)</span> at <span class="math notranslate nohighlight">\(t_{i+1}\)</span>. Actual rate used during a time step that ends at time <span class="math notranslate nohighlight">\(t\)</span>, with <span class="math notranslate nohighlight">\(t_i \le t \le t_{i+1}\)</span>, is automatically adjusted in such a way that total cumulative exchanged mass at time <span class="math notranslate nohighlight">\(t\)</span></div>
</div>
<div class="math notranslate nohighlight" id="equation-eq-50">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-50" title="Link to this equation">#</a></span>\[Q(t) = \int_0^t q dt^{'} = \sum_{j=1}^{i-1} q_j \left( t_{j+1} - t_j \right) + q \left( t - t_i \right)\]</div>
<div class="line-block">
<div class="line">is rigorously conserved. If also tabular data for enthalpies are given, an analogous adjustment is made for fluid enthalpy, to preserve <span class="math notranslate nohighlight">\(\int qh dt\)</span>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(13)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">determines content of <em>INCON</em> and <em>SAVE</em> files:</div>
<div class="line">0: standard content.</div>
<div class="line">1: writes user-specified initial conditions to file <em>SAVE</em>.</div>
<div class="line">2: reads parameters of hysteresis model from file <em>INCON</em>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(14)</span></code></p></td>
<td><p>I1</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(15)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">determines conductive heat exchange with impermeable geologic formations using semi-analytical methods:</div>
<div class="line">0: heat exchange is off.</div>
<div class="line">1: linear heat exchange <em>between a reservoir and confining beds</em> is on (for grid blocks that have a non-zero heat transfer area; see data block <strong>ELEME</strong>). Initial temperature in cap- or base-rock is assumed uniform and taken as the temperature with which the last element in data block <strong>ELEME</strong> is initialized.</div>
<div class="line">2: linear heat exchange <em>between a reservoir and confining beds</em> is on. Initial temperature for the confining bed adjacent to an element that has a non-zero heat transfer area is taken as the temperature of that element in data block <strong>INCON</strong>.</div>
<div class="line">Heat capacity and conductivity of the confining beds are specified in block <strong>ROCKS</strong> for the particular domain to which the very last volume element in data block <strong>ELEME</strong> belongs. Thus, if a semi-analytical heat exchange calculation is desired, the user would append an additional dummy element of a very large volume at the end of the <strong>ELEME</strong> block, and provide the desired parameters as initial conditions and domain data, respectively, for this element. It is necessary to specify which elements have an interface area with the confining beds, and to give the magnitude of this interface area. This information is input as parameter <code class="docutils literal notranslate"><span class="pre">AHTX</span></code> in columns 31-40 of volume element data in block <strong>ELEME</strong>. Volume elements for which a zero-interface area is specified will not be subject to heat exchange. A sample problem using <code class="docutils literal notranslate"><span class="pre">MOP(15)</span></code> = 1 is included in the addendum for EOS1.</div>
<div class="line">5: radial heat exchange <em>between fluids in a wellbore and the surrounding formation</em> is on. Constant well and formation properties are given in a material named QLOSS with the following parameters:</div>
<div class="line-block">
<div class="line">- <code class="docutils literal notranslate"><span class="pre">DROK</span></code>: Rock grain density [kg/m<sup>3</sup>] of formation near well</div>
<div class="line">- <code class="docutils literal notranslate"><span class="pre">POR</span></code>: Well radius [m]</div>
<div class="line">- <code class="docutils literal notranslate"><span class="pre">PER(1)</span></code>: Reference elevation [m]; specify Z coordinate in block <strong>ELEME</strong>, columns 71-80</div>
<div class="line">- <code class="docutils literal notranslate"><span class="pre">PER(2)</span></code>: Reference temperature [˚C]</div>
<div class="line">- <code class="docutils literal notranslate"><span class="pre">PER(3)</span></code>: Geothermal gradient [˚C/m]</div>
<div class="line">- <code class="docutils literal notranslate"><span class="pre">CWET</span></code>: Heat conductivity [W/kg ˚C] of formation near well</div>
<div class="line">- <code class="docutils literal notranslate"><span class="pre">SPHT</span></code>: Rock grain specific heat [J/kg ˚C] of formation near well</div>
</div>
<div class="line">6: radial heat exchange <em>between fluids in a wellbore and the surrounding formation</em> is on. Depth-dependent well and formation properties (depth, radius, temperature, conductivity, density, capacity) are provided on an external file named <em>radqloss.dat</em> with the information in the following format: on the first line, <code class="docutils literal notranslate"><span class="pre">NMATQLOSS</span></code> is the number of elevations with geometric and thermal data, and <code class="docutils literal notranslate"><span class="pre">NMATQLOSS</span></code> lines are provided with the following data in free format: elevation [m], well radius [m], initial temperature [˚C], <code class="docutils literal notranslate"><span class="pre">CWET</span></code>, <code class="docutils literal notranslate"><span class="pre">DROK</span></code>, <code class="docutils literal notranslate"><span class="pre">SPHT</span></code>. Between elevations, properties are calculated using linear interpolation.</div>
<div class="line">RESTART is possible for linear heat exchange between a reservoir and confining beds (<code class="docutils literal notranslate"><span class="pre">MOP(15)</span></code> = 1 or 2), but not for radial heat exchange (<code class="docutils literal notranslate"><span class="pre">MOP(15)</span></code> = 5 or 6). The data necessary for continuing the linear heat exchange calculation in a TOUGH3 continuation run are written onto a disk file <em>TABLE</em>. When restarting a problem, this file has to be provided under the name <em>TABLE</em>. If file <em>TABLE</em> is absent, TOUGH3 assumes that no prior heat exchange with confining beds has taken place.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(16)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">provides automatic time step control:</div>
<div class="line">0: automatic time stepping based on maximum change in saturation.</div>
<div class="line">1: automatic time stepping based on number of iterations needed for convergence.</div>
<div class="line">&gt;1: time step size will be doubled if convergence occurs within ITER ≤ <code class="docutils literal notranslate"><span class="pre">MOP(16)</span></code> Newton-Raphson iterations. It is recommended to set <code class="docutils literal notranslate"><span class="pre">MOP(16)</span></code> in the range of 2-4.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(17)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">handles time stepping after linear equation solver failure:</div>
<div class="line">0: no time step reduction despite linear equation solver failure.</div>
<div class="line">9: reduce time step after linear equation solver failure.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(18)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">selects handling of interface density:</div>
<div class="line">0: perform upstream weighting for interface density.</div>
<div class="line">&gt;0: average interface density between the two grid blocks. However, when one of the two phase saturations is zero, upstream weighting will be performed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(19)</span></code></p></td>
<td><p>I1</p></td>
<td><p>switch used by different EOS modules for conversion of primary variables.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(20)</span></code></p></td>
<td><p>I1</p></td>
<td><p>switch for vapor pressure lowering in EOS4; <code class="docutils literal notranslate"><span class="pre">MOP(20)</span></code> = 1 optionally suppresses vapor pressure lowering effects.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(21)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">selects the linear equation solver:</div>
<div class="line">0: defaults to <code class="docutils literal notranslate"><span class="pre">MOP(21)</span></code> = 3, DSLUCS, Lanczos-type preconditioned bi-conjugate gradient solver.</div>
<div class="line">1: (void)</div>
<div class="line">2: DSLUBC, bi-conjugate gradient solver.</div>
<div class="line">3: DSLUCS (default).</div>
<div class="line">4: DSLUGM, generalized minimum residual preconditioned conjugate gradient solver.</div>
<div class="line">5: DLUSTB, stabilized bi-conjugate gradient solver.</div>
<div class="line">6: LUBAND, banded direct solver.</div>
<div class="line">7: AZTEC parallel iterative solver.</div>
<div class="line">8: PETSc parallel iterative solver.</div>
<div class="line">All conjugate gradient solvers use incomplete LU-factorization as a default preconditioner. Other preconditioners may be chosen by means of a data block <strong>SOLVR</strong>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(22)</span></code></p></td>
<td><p>I1</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(23)</span></code></p></td>
<td><p>I1</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP(24)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">determines handling of multiphase diffusive fluxes at interfaces:</div>
<div class="line">- 0: harmonic weighting of fully coupled effective multiphase diffusivity.</div>
<div class="line">- 1: separate harmonic weighting of gas and liquid phase diffusivities.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TEXP</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>parameter for temperature dependence of gas phase diffusion coefficient (see Eq. <a class="reference internal" href="governing_equations.html#equation-eq-13">(13)</a>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BE</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>(optional) parameter for effective strength of enhanced vapor diffusion; if set to a non-zero value, will replace the parameter group <span class="math notranslate nohighlight">\(\phi \tau_0 \tau_{\beta}\)</span> for vapor diffusion (see Eq. <a class="reference internal" href="governing_equations.html#equation-eq-10">(10)</a>).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-param-2">
<caption><span class="caption-number">Table 13 </span><span class="caption-text">Record <strong>PARAM.2</strong>.</span><a class="headerlink" href="#tab-param-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TSTART</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>starting time of simulation in seconds (default is 0).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TIMAX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>time in seconds at which simulation should stop (default is infinite).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DELTEN</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>length of time steps in seconds. If <code class="docutils literal notranslate"><span class="pre">DELTEN</span></code> is a negative integer, <code class="docutils literal notranslate"><span class="pre">DELTEN</span></code> = -<code class="docutils literal notranslate"><span class="pre">NDLT</span></code>, the program will proceed to read <code class="docutils literal notranslate"><span class="pre">NDLT</span></code> records with time step information. Note that -<code class="docutils literal notranslate"><span class="pre">NDLT</span></code> must be provided as a floating point number, with decimal point.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DELTMX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>upper limit for time step size in seconds (default is infinite).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ELST</span></code></p></td>
<td><p>A5</p></td>
<td><p>no longer supported in TOUGH3. For printout after each time step, use <strong>FOFT</strong> instead.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GF</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>magnitude (m/s<sup>2</sup>) of the gravitational acceleration vector. Blank or zero gives “no gravity” calculation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">REDLT</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>factor by which time step is reduced in case of convergence failure or other problems (default is 4).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SCALE</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>scale factor to change the size of the mesh (default = 1.0).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-param-2-1">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Record <strong>PARAM.2.1</strong>.</span><a class="headerlink" href="#tab-param-2-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DLT(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>Length (in seconds) of time step <code class="docutils literal notranslate"><span class="pre">I</span></code>. This set of records is optional for <code class="docutils literal notranslate"><span class="pre">DELTEN</span></code> = -<code class="docutils literal notranslate"><span class="pre">NDLT</span></code>, a negative integer. Up to 13 records can be read, each containing 8 time step data. If the number of simulated time steps exceeds the number of <code class="docutils literal notranslate"><span class="pre">DLT(I)</span></code>, the simulation will continue with time steps determined by automatic time step control (<code class="docutils literal notranslate"><span class="pre">MOP(16)</span></code>).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-param-3">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">Record <strong>PARAM.3</strong>.</span><a class="headerlink" href="#tab-param-3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RE1</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>convergence criterion for relative error (default 10<sup>-5`</sup>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RE2</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>convergence criterion for absolute error (default 1).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">WUP</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>upstream weighting factor for mobilities and enthalpies at interfaces (default 1.0 is recommended). 0 ≤ <code class="docutils literal notranslate"><span class="pre">WUP</span></code> ≤ 1.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">WNR</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>weighting factor for increments in Newton/Raphson - iteration (default 1.0 is recommended). 0 &lt; <code class="docutils literal notranslate"><span class="pre">WNR</span></code> ≤ 1.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DFAC</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>increment factor for numerically computing derivatives (default value is <code class="docutils literal notranslate"><span class="pre">DFAC</span></code> = 10<sup>-k/2</sup>, where <span class="math notranslate nohighlight">\(k\)</span>, evaluated internally, is the number of significant digits of the floating point processor used; for 64-bit arithmetic, <code class="docutils literal notranslate"><span class="pre">DFAC</span></code> ≈ 10<sup>-8</sup>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FOR</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>factor to change the size of the time step during the Newtonian iteration (default 1.0).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AMRES</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>maximum permissible residual during the Newtonian iteration. If a residual larger than <code class="docutils literal notranslate"><span class="pre">AMRES</span></code> is encountered, time step will automatically be reduced (default 10<sup>5</sup>).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-param-4">
<caption><span class="caption-number">Table 16 </span><span class="caption-text">Record <strong>PARAM.4</strong>.</span><a class="headerlink" href="#tab-param-4" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">X(I)</span></code></p></td>
<td><p>E20.13</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NKIN</span></code> + 1 primary variables which are used as default initial conditions for all grid blocks that are not assigned by means of data blocks <strong>INDOM</strong> or <strong>INCON</strong>. Option <strong>START</strong> is necessary to use default <strong>INCON</strong>. Different sets of primary variables are in use for different EOS modules.</p></td>
</tr>
</tbody>
</table>
<p>The number of primary variables, <code class="docutils literal notranslate"><span class="pre">NKIN</span></code> + 1, is normally assigned internally in the EOS module, and is usually equal to the number <code class="docutils literal notranslate"><span class="pre">NEQ</span></code> of equations solved per grid block.
See data block <strong>MULTI</strong> for special assignments of <code class="docutils literal notranslate"><span class="pre">NKIN</span></code>.
When more than four primary variables are used more than one line (record) must be provided.</p>
</section>
<section id="indom">
<h3>INDOM<a class="headerlink" href="#indom" title="Link to this heading">#</a></h3>
<p>Introduces domain-specific initial conditions.
These will supersede default initial conditions specified in <strong>PARAM.4</strong>, and can be overwritten by element-specific initial conditions in data block <strong>INCON</strong>.
Option <strong>START</strong> is needed to use <strong>INDOM</strong> conditions.</p>
<table class="table table-center" id="tab-imdom-1">
<caption><span class="caption-number">Table 17 </span><span class="caption-text">Record <strong>INDOM.1</strong>.</span><a class="headerlink" href="#tab-imdom-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MAT</span></code></p></td>
<td><p>A5</p></td>
<td><p>name of a reservoir domain, as specified in data block <strong>ROCKS</strong>.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-imdom-2">
<caption><span class="caption-number">Table 18 </span><span class="caption-text">Record <strong>INDOM.2</strong>.</span><a class="headerlink" href="#tab-imdom-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">X(I)</span></code></p></td>
<td><p>E20.13</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NKIN</span></code> + 1 primary variables assigned to all grid blocks in the domain specified in record <strong>INDOM.1</strong>. Different sets of primary variables are used for different EOS modules.</p></td>
</tr>
</tbody>
</table>
<p>A blank record closes the <strong>INDOM</strong> data block.
Repeat records <strong>INDOM.1</strong> and <strong>INDOM.2</strong> for as many domains as desired.
The ordering is arbitrary and need not be the same as in block <strong>ROCKS</strong>.</p>
</section>
<section id="incon">
<h3>INCON<a class="headerlink" href="#incon" title="Link to this heading">#</a></h3>
<p>Introduces element-specific initial conditions.</p>
<table class="table table-center" id="tab-incon-1">
<caption><span class="caption-number">Table 19 </span><span class="caption-text">Record <strong>INCON.1</strong>.</span><a class="headerlink" href="#tab-incon-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EL</span></code>, <code class="docutils literal notranslate"><span class="pre">NE</span></code></p></td>
<td><p>A3, I2</p></td>
<td><p>code name of element.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NSEQ</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of additional elements with the same initial conditions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NADD</span></code></p></td>
<td><p>I5</p></td>
<td><p>increment between the code numbers of two successive elements with identical initial conditions.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PORX</span></code></p></td>
<td><p>E15.9</p></td>
<td><p>porosity; if zero or blank, porosity will be taken as specified in block <strong>ROCKS</strong> if option <strong>START</strong> is used.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">USRX(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, 5 grid block specific parameters (optional).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-incon-2">
<caption><span class="caption-number">Table 20 </span><span class="caption-text">Record <strong>INCON.2</strong>.</span><a class="headerlink" href="#tab-incon-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">X(I)</span></code></p></td>
<td><p>E20.14</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NKIN</span></code> + 1 primary variables for the element specified in record <strong>INCON.1</strong>. <strong>INCON</strong> specifications will supersede default conditions specified in <strong>PARAM.4</strong>, and domain-specific conditions that may have been specified in data block <strong>INDOM</strong>. Different sets of primary variables are used for different EOS modules.</p></td>
</tr>
</tbody>
</table>
<p>A blank record closes the <strong>INCON</strong> data block.
Alternatively, initial condition information may terminate on a record with <code class="docutils literal notranslate"><span class="pre">+++</span></code> typed in the first three columns, followed by time stepping information.
This feature is used for a continuation run from a previous TOUGH3 simulation.</p>
</section>
<section id="solvr-optional">
<h3>SOLVR (optional)<a class="headerlink" href="#solvr-optional" title="Link to this heading">#</a></h3>
<p>Introduces a data block with parameters for linear equation solvers.
For the parallel solvers, only <code class="docutils literal notranslate"><span class="pre">MATSLV</span></code> is used, and the other options should be specified through the PETSc (<em>.petscrc</em>) and Aztec (<em>.aztecrc</em>) option files.</p>
<table class="table table-center" id="tab-solvr-1">
<caption><span class="caption-number">Table 21 </span><span class="caption-text">Record <strong>SOLVR.1</strong>.</span><a class="headerlink" href="#tab-solvr-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MATSLV</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">selects the linear equation solver:</div>
<div class="line">1: (void)</div>
<div class="line">2: DSLUBC, a bi-conjugate gradient solver</div>
<div class="line">3: DSLUCS, a Lanczos-type bi-conjugate gradient solver</div>
<div class="line">4: DSLUGM, a generalized minimum residual solver</div>
<div class="line">5: DLUSTB, a stabilized bi-conjugate gradient solver</div>
<div class="line">6: direct solver LUBAND</div>
<div class="line">7: AZTEC parallel iterative solver</div>
<div class="line">8: PETSc parallel iterative solver</div>
</div>
</td>
</tr>
<tr class="row-odd"><td></td>
<td><p>2X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ZPROCS</span></code></p></td>
<td><p>A2</p></td>
<td><div class="line-block">
<div class="line">selects the Z-preconditioning (<span id="id6"><a class="reference internal" href="../references.html#id58" title="Moridis, G. J., &amp; Pruess, K. (1998). T2solv: an enhanced package of solvers for the tough2 family of reservoir simulation codes. Geothermics, 27(4), 415–444.">Moridis &amp; Pruess, 1998</a></span>). Regardless of user specifications, Z-preprocessing will only be performed when iterative solvers are used (2 ≤ <code class="docutils literal notranslate"><span class="pre">MATSLV</span></code> ≤ 5), and if there are zeros on the main diagonal of the Jacobian matrix:</div>
<div class="line">Z0: no Z-preprocessing (default for <code class="docutils literal notranslate"><span class="pre">NEQ</span></code> = 1)</div>
<div class="line">Z1: replace zeros on the main diagonal by a small constant (10<sup>-25</sup>; default for <code class="docutils literal notranslate"><span class="pre">NEQ</span></code> ≠ 1)</div>
<div class="line">Z2: make linear combinations of equations for each grid block to achieve non-zeros on the main diagonal</div>
<div class="line">Z3: normalize equations, followed by Z2</div>
<div class="line">Z4: affine transformation to unit main-diagonal submatrices, without center pivoting</div>
</div>
</td>
</tr>
<tr class="row-odd"><td></td>
<td><p>3X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">OPROCS</span></code></p></td>
<td><p>A2</p></td>
<td><div class="line-block">
<div class="line">selects the O-preconditioning (<span id="id7"><a class="reference internal" href="../references.html#id58" title="Moridis, G. J., &amp; Pruess, K. (1998). T2solv: an enhanced package of solvers for the tough2 family of reservoir simulation codes. Geothermics, 27(4), 415–444.">Moridis &amp; Pruess, 1998</a></span>):</div>
<div class="line">O0: no O-preprocessing (default, also invoked for <code class="docutils literal notranslate"><span class="pre">NEQ</span></code> = 1)</div>
<div class="line">O1: eliminate lower half of the main-diagonal submatrix with center pivoting</div>
<div class="line">O2: O1, plus eliminate upper half of the main-diagonal submatrix with center pivoting</div>
<div class="line">O3: O2, plus normalize, resulting in unit main-diagonal submatrices</div>
<div class="line">O4: affine transformation to unit main-diagonal submatrices, without center pivoting</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RITMAX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>selects the maximum number of CG iterations as a fraction of the total number of equations (0.0 &lt; <code class="docutils literal notranslate"><span class="pre">RITMAX</span></code> ≤ 1.0; default is <code class="docutils literal notranslate"><span class="pre">RITMAX</span></code> = 0.1).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CLOSUR</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>convergence criterion for the CG iterations (10<sup>-12</sup> ≤ <code class="docutils literal notranslate"><span class="pre">CLOSUR</span></code> ≤ 10<sup>-6</sup>; default is <code class="docutils literal notranslate"><span class="pre">CLOSUR</span></code> = 10<sup>-6</sup>)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="foft-optional">
<h3>FOFT (optional)<a class="headerlink" href="#foft-optional" title="Link to this heading">#</a></h3>
<p>Introduces a list of elements (grid blocks) for which time-dependent data are to be written out for plotting during the simulation.
A separate file is generated for each element in CSV format.
The name of each file starts with <em>FOFT</em>, and includes the element name. If regular or simple hysteresis is invoked via <code class="docutils literal notranslate"><span class="pre">IRP</span></code> = <code class="docutils literal notranslate"><span class="pre">ICP</span></code> = 12 or <code class="docutils literal notranslate"><span class="pre">IRP</span></code> = <code class="docutils literal notranslate"><span class="pre">ICP</span></code> = 13, then relevant hysteresis parameters are also written to <em>FOFT</em>.
If <code class="docutils literal notranslate"><span class="pre">MOP2(17)</span></code> &gt; 0, print variables according to the input data in block <strong>OUTPU</strong>.</p>
<table class="table table-center" id="tab-foft-1">
<caption><span class="caption-number">Table 22 </span><span class="caption-text">Record <strong>FOFT.1</strong>.</span><a class="headerlink" href="#tab-foft-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EFOFT</span></code></p></td>
<td><p>A5</p></td>
<td><p>element name.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IFOFTF</span></code></p></td>
<td><p>I5</p></td>
<td><div class="line-block">
<div class="line">a flag to control the amount of printout:</div>
<div class="line">0: default printout of pressure, temperature, and saturation of flowing phases.</div>
<div class="line">&gt;0: print out mass fraction of each component in the specified phase in addition to the default printout.</div>
<div class="line">&lt;0: print out mass fraction of each component in each of all the flowing phases in addition to the default printout.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>A blank record closes the <strong>FOFT</strong> data block.
Repeat records <strong>FOFT.1</strong> for as many elements as desired.</p>
</section>
<section id="coft-optional">
<h3>COFT (optional)<a class="headerlink" href="#coft-optional" title="Link to this heading">#</a></h3>
<p>Introduces a list of connections for which time-dependent data are to be written out for plotting during the simulation.
A separate file is generated for each connection in CSV format.
The name of each file starts with <em>COFT</em>, and includes the pair of two element names.</p>
<table class="table table-center" id="tab-coft-1">
<caption><span class="caption-number">Table 23 </span><span class="caption-text">Record <strong>COFT.1</strong>.</span><a class="headerlink" href="#tab-coft-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ECOFT</span></code></p></td>
<td><p>A10</p></td>
<td><p>a connection name, i.e., an ordered pair of two element names (no blank between elements).</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>10X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ICOFTF</span></code></p></td>
<td><p>I5</p></td>
<td><div class="line-block">
<div class="line">a flag to control the amount of printout:</div>
<div class="line">0: default printout of heat flux and flow rate of each flowing phase.</div>
<div class="line">&gt;0: print out fractional mass flow of each component in the specified phase in addition to the default printout.</div>
<div class="line">&lt;0: print out fractional mass flow of each component in each of all the flowing phases in addition to the default printout.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>A blank record closes the <strong>COFT</strong> data block.
Repeat records <strong>COFT.1</strong> for as many connections as desired.</p>
</section>
<section id="goft-optional">
<h3>GOFT (optional)<a class="headerlink" href="#goft-optional" title="Link to this heading">#</a></h3>
<p>Introduces a list of sinks/sources for which time-dependent data are to be written out for plotting during the simulation.
A separate file is generated for each sink/source in CSV format.
The name of each file starts with <em>GOFT</em>, and includes the sink/source name.</p>
<table class="table table-center" id="tab-goft-1">
<caption><span class="caption-number">Table 24 </span><span class="caption-text">Record <strong>GOFT.1</strong>.</span><a class="headerlink" href="#tab-goft-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EGOFT</span></code></p></td>
<td><p>A5</p></td>
<td><p>the name of an element in which a sink/source is defined.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IGOFTF</span></code></p></td>
<td><p>I5</p></td>
<td><div class="line-block">
<div class="line">a flag to control the amount of printout:</div>
<div class="line">0: default printout of mass flow rate and flowing enthalpy.</div>
<div class="line">&gt;0: print out fractional mass flow rate of the specified phase in addition to the default printout.</div>
<div class="line">&lt;0: print out fractional mass flow rate of each of all the flowing phases in addition to the default printout.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>A blank record closes the <strong>GOFT</strong> data block.
Repeat records <strong>GOFT.1</strong> for as many sinks/sources as desired.</p>
</section>
<section id="diffu-optional">
<h3>DIFFU (optional)<a class="headerlink" href="#diffu-optional" title="Link to this heading">#</a></h3>
<p>Introduces diffusion coefficients (needed only for <code class="docutils literal notranslate"><span class="pre">NB</span></code> = 8).</p>
<table class="table table-center" id="tab-diffu-1">
<caption><span class="caption-number">Table 25 </span><span class="caption-text">Record <strong>DIFFU.1</strong>.</span><a class="headerlink" href="#tab-diffu-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FDDIAG(I,</span> <span class="pre">1)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NPH</span></code> diffusion coefficients for mass component #1 in all phases (<code class="docutils literal notranslate"><span class="pre">I</span></code> = 1: gas; <code class="docutils literal notranslate"><span class="pre">I</span></code> = 2: aqueous; etc).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-diffu-2">
<caption><span class="caption-number">Table 26 </span><span class="caption-text">Record <strong>DIFFU.2</strong>.</span><a class="headerlink" href="#tab-diffu-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FDDIAG(I,</span> <span class="pre">2)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NPH</span></code> diffusion coefficients for mass component #2 in all phases (<code class="docutils literal notranslate"><span class="pre">I</span></code> = 1: gas; <code class="docutils literal notranslate"><span class="pre">I</span></code> = 2: aqueous; etc).</p></td>
</tr>
</tbody>
</table>
<p>Provide a total of <code class="docutils literal notranslate"><span class="pre">NK</span></code> records with diffusion coefficients for all <code class="docutils literal notranslate"><span class="pre">NK</span></code> mass components.</p>
</section>
<section id="selec">
<h3>SELEC<a class="headerlink" href="#selec" title="Link to this heading">#</a></h3>
<p>Introduces a number of integer and floating point parameters that are
used for different purposes in different TOUGH3 modules (EOS7, EOS7R,
EWASG, ECO2N, ECO2M, TMVOC).
Note that TOUGH3 includes additional <code class="docutils literal notranslate"><span class="pre">IE</span></code> options for the calculation of brine properties in EWASG, ECO2N, and ECO2M.</p>
<table class="table table-center" id="tab-selec-1">
<caption><span class="caption-number">Table 27 </span><span class="caption-text">Record <strong>SELEC.1</strong>.</span><a class="headerlink" href="#tab-selec-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IE(I)</span></code></p></td>
<td><p>I5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, 16 EOS-specific integer options.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">IE(1)</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of records with floating point numbers that will be read (default is <code class="docutils literal notranslate"><span class="pre">IE(1)</span></code> = 1; maximum values is 64).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-selec-2">
<caption><span class="caption-number">Table 28 </span><span class="caption-text">Record <strong>SELEC.2</strong>.</span><a class="headerlink" href="#tab-selec-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FE(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">IE(1)</span></code> * 8 EOS-specific floating point numbers.</p></td>
</tr>
</tbody>
</table>
<p>Provide as many <strong>SELEC.2</strong> (<a class="reference internal" href="#tab-selec-2"><span class="std std-numref">Table 28</span></a>) records with floating point numbers as specified in <code class="docutils literal notranslate"><span class="pre">IE(1)</span></code>, up to a maximum of 64 records.</p>
</section>
<section id="rpcap">
<h3>RPCAP<a class="headerlink" href="#rpcap" title="Link to this heading">#</a></h3>
<p>Introduces information on relative permeability and capillary pressure functions, which will be applied for all flow domains for which no data were specified in records <strong>ROCKS.1.2</strong> (<a class="reference internal" href="#tab-rocks-1-2"><span class="std std-numref">Table 7</span></a>) and <strong>ROCKS.1.3</strong> (<a class="reference internal" href="#tab-rocks-1-3"><span class="std std-numref">Table 9</span></a>).</p>
<table class="table table-center" id="tab-rpcap-1">
<caption><span class="caption-number">Table 29 </span><span class="caption-text">Record <strong>RPCAP.1</strong>.</span><a class="headerlink" href="#tab-rpcap-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IRP</span></code></p></td>
<td><p>I5</p></td>
<td><p>integer parameter to choose type of relative permeability function.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, …, 7 parameters for relative permeability function.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-rpcap-2">
<caption><span class="caption-number">Table 30 </span><span class="caption-text">Record <strong>RPCAP.2</strong> (optional, <code class="docutils literal notranslate"><span class="pre">IRP</span></code> = 12 only).</span><a class="headerlink" href="#tab-rpcap-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 8, …, 10 parameters for relative permeability function.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-rpcap-3">
<caption><span class="caption-number">Table 31 </span><span class="caption-text">Record <strong>RPCAP.3</strong>.</span><a class="headerlink" href="#tab-rpcap-3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ICP</span></code></p></td>
<td><p>I5</p></td>
<td><p>integer parameter to choose type of capillary pressure function.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, …, 7 parameters for capillary pressure function.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-rpcap-4">
<caption><span class="caption-number">Table 32 </span><span class="caption-text">Record <strong>RPCAP.4</strong> (optional, <code class="docutils literal notranslate"><span class="pre">ICP</span></code> = 12 only).</span><a class="headerlink" href="#tab-rpcap-4" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CP(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 8, …, 13 parameters for capillary pressure function.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="hyste-optional">
<h3>HYSTE (optional)<a class="headerlink" href="#hyste-optional" title="Link to this heading">#</a></h3>
<p>Provides numerical controls on the hysteretic characteristic curves.
It is not needed if the default values of all its parameters are to be used.</p>
<table class="table table-center" id="tab-hyste-1">
<caption><span class="caption-number">Table 33 </span><span class="caption-text">Record <strong>HYSTE.1</strong>.</span><a class="headerlink" href="#tab-hyste-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IEHYS(1)</span></code></p></td>
<td><p>I5</p></td>
<td><div class="line-block">
<div class="line">flag to print information about hysteretic characteristic curves:</div>
<div class="line">=0: no additional print out.</div>
<div class="line">≥1: print a one-line message to the output file every time a capillary-pressure branch switch occurs (recommended).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">IEHYS(2)</span></code></p></td>
<td><p>I5</p></td>
<td><div class="line-block">
<div class="line">flag indicating when to apply capillary-pressure branch switching:</div>
<div class="line">=0: after convergence of time step (recommended).</div>
<div class="line">&gt;0: after each Newton-Raphson iteration.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IEHYS(3)</span></code></p></td>
<td><p>I5</p></td>
<td><div class="line-block">
<div class="line">run parameter for sub-threshold saturation change:</div>
<div class="line">=0: no branch switch unless <span class="math notranslate nohighlight">\(\left\vert \Delta S \right\vert\)</span> &gt; <code class="docutils literal notranslate"><span class="pre">CP(10)</span></code>.</div>
<div class="line">&gt;0: allow branch switch after run of <code class="docutils literal notranslate"><span class="pre">IEHYS(3)</span></code> consecutive time steps for which all <span class="math notranslate nohighlight">\(\left\vert \Delta S \right\vert\)</span> &lt; <code class="docutils literal notranslate"><span class="pre">CP(10)</span></code> and all <span class="math notranslate nohighlight">\(\Delta S\)</span> are the same sign. Recommended value 5-10. This option may be useful if the time step is cut to a small value due to convergence problems, making saturation changes very small.</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="times-optional">
<h3>TIMES (optional)<a class="headerlink" href="#times-optional" title="Link to this heading">#</a></h3>
<p>Permits the user to obtain printout at specified times.
This printout will occur in addition to printout specified in record <strong>PARAM.1</strong>.</p>
<table class="table table-center" id="tab-times-1">
<caption><span class="caption-number">Table 34 </span><span class="caption-text">Record <strong>TIMES.1</strong>.</span><a class="headerlink" href="#tab-times-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ITI</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of times provided on records <strong>TIMES.2</strong>, <strong>TIMES.3</strong>, etc.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ITE</span></code></p></td>
<td><p>I5</p></td>
<td><p>total number of times desired (<code class="docutils literal notranslate"><span class="pre">ITI</span></code> ≤ <code class="docutils literal notranslate"><span class="pre">ITE</span></code>; default is <code class="docutils literal notranslate"><span class="pre">ITE</span></code> = <code class="docutils literal notranslate"><span class="pre">ITI</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DELAF</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>maximum time step size after any of the prescribed times have been reached (default is infinite).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TINTER</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>time increment for times with index <code class="docutils literal notranslate"><span class="pre">ITI</span></code>, <code class="docutils literal notranslate"><span class="pre">ITI</span></code> + 1, …, <code class="docutils literal notranslate"><span class="pre">ITE</span></code>.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-times-2">
<caption><span class="caption-number">Table 35 </span><span class="caption-text">Record <strong>TIMES.2</strong>.</span><a class="headerlink" href="#tab-times-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIS(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">ITI</span></code> times (in ascending order) at which printout is desired.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="eleme">
<h3>ELEME<a class="headerlink" href="#eleme" title="Link to this heading">#</a></h3>
<p>Introduces element (grid block) information.</p>
<table class="table table-center" id="tab-eleme-1">
<caption><span class="caption-number">Table 36 </span><span class="caption-text">Record <strong>ELEME.1</strong>.</span><a class="headerlink" href="#tab-eleme-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EL</span></code>, <code class="docutils literal notranslate"><span class="pre">NE</span></code></p></td>
<td><p>A3, I2</p></td>
<td><p>five-character code name of an element. The first three characters are arbitrary, the last two characters must be numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NSEQ</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of additional elements having the same volume and belonging to the same reservoir domain.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NADD</span></code></p></td>
<td><p>I5</p></td>
<td><p>increment between the code numbers of two successive elements. (Note: the maximum permissible code number <code class="docutils literal notranslate"><span class="pre">NE</span></code> + <code class="docutils literal notranslate"><span class="pre">NSEQ</span></code> × <code class="docutils literal notranslate"><span class="pre">NADD</span></code> is ≤ 99).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MA1</span></code>, <code class="docutils literal notranslate"><span class="pre">MA2</span></code></p></td>
<td><p>A3, A2</p></td>
<td><p>a five-character material identifier corresponding to one of the reservoir domains as specified in block <strong>ROCKS</strong>. If the first three characters are blanks and the last two characters are numbers then they indicate the sequence number of the domain as entered in <strong>ROCKS</strong>. If both <code class="docutils literal notranslate"><span class="pre">MA1</span></code> and <code class="docutils literal notranslate"><span class="pre">MA2</span></code> are left blank the element is by default assigned to the first domain in block <strong>ROCKS</strong>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">VOLX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>element volume (m<sup>3`</sup>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AHTX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>interface area (m<sup>2</sup>) for linear heat exchange with semi-infinite confining beds. Internal MESH generation via MESHMaker will automatically assign <code class="docutils literal notranslate"><span class="pre">AHTX</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PMX</span></code></p></td>
<td><p>E10.4</p></td>
<td><div class="line-block">
<div class="line">block-by-block permeability modification coefficient, <span class="math notranslate nohighlight">\(\zeta_n\)</span> (optional). The <code class="docutils literal notranslate"><span class="pre">PMX</span></code> may be used to specify spatially correlated heterogeneous fields. But users need to run their own geostatistical program to generate the fields they desire, and then use preprocessing programs to place the modification coefficients into the <strong>ELEME</strong> data block, as TOUGH3 provides no internal capabilities for generating such fields.</div>
<div class="line">If a dummy domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” is specified in data block <strong>ROCKS</strong>, it will be used as multiplicative factor for all the permeability parameters from block ROCKS (see Eq. <a class="reference internal" href="#equation-eq-48">(45)</a>), and strength of capillary pressure will be scaled according to Eq. <a class="reference internal" href="#equation-eq-49">(46)</a>. With a dummy domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” in data block <strong>ROCKS</strong>, <code class="docutils literal notranslate"><span class="pre">PMX</span></code> = 0 will result in an impermeable block.</div>
<div class="line">In TOUGH3, <code class="docutils literal notranslate"><span class="pre">PMX</span></code> can be active without a dummy domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” in the ROCKS block. If a dummy domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” is not specified in data block <strong>ROCKS</strong>, it can be used to specify grid block permeabilities or permeability modifiers. If a positive value less than 10<sup>-4</sup> is given, it is interpreted as absolute permeability; if a negative value is provided, it is interpreted as a permeability modifier, i.e., a factor with which the absolute permeability specified in block <strong>ROCKS</strong> is multiplied. Alternatively, the same information can be provided through <code class="docutils literal notranslate"><span class="pre">USRX</span></code> (columns 31-40) in block <strong>INCON</strong>.</div>
<div class="line">If <code class="docutils literal notranslate"><span class="pre">PMX</span></code> is blank for the first element, the element-by-element permeabilities are ignored. If a dummy domain “<code class="docutils literal notranslate"><span class="pre">SEED</span></code>” is not specified in data block <strong>ROCKS</strong>, strength of capillary pressure will not be automatically scaled. Leverett scaling of capillary pressure can be applied with <code class="docutils literal notranslate"><span class="pre">MOP2(6)</span></code> &gt; 0 in data block <strong>MOMOP</strong>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, <code class="docutils literal notranslate"><span class="pre">Z</span></code></p></td>
<td><p>3E10.4</p></td>
<td><p>Cartesian coordinates of grid block centers. These may be included in the <strong>ELEME</strong> data to make subsequent plotting of results more convenient. Note that coordinates are not used in TOUGH3; the exceptions are for optional initialization of a gravity-capillary equilibrium with EOS9 and for optional addition of potential energy to enthalpy with <code class="docutils literal notranslate"><span class="pre">MOP2(12)</span></code> &gt; 0 in data block <strong>MOMOP</strong>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">USERX(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>anisotropic permeability or permeability modifier of the X-, Y-, and Z-direction for <code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, 2, and 3, respectively. Based on the values, TOUGH3 will internally determine whether it is permeability itself or permeability modifier. To read three permeabilities or permeability modifiers, <code class="docutils literal notranslate"><span class="pre">MOP2(20)</span></code> in data block <strong>MOMOP</strong> should be set according to Table 7. Alternatively, the same information can be provided through <code class="docutils literal notranslate"><span class="pre">USRX</span></code> (columns 31-60) in block <strong>INCON</strong>. To write these element-by-element parameters to file <em>SAVE</em>, set <code class="docutils literal notranslate"><span class="pre">MOP(13)</span></code> = 1.</p></td>
</tr>
</tbody>
</table>
<p>Repeat record <strong>ELEME.1</strong> for the number of elements desired.</p>
<p>A blank record closes the <strong>ELEME</strong> data block.</p>
</section>
<section id="conne">
<h3>CONNE<a class="headerlink" href="#conne" title="Link to this heading">#</a></h3>
<p>Introduces information for the connections (interfaces) between elements.</p>
<table class="table table-center" id="tab-conne-1">
<caption><span class="caption-number">Table 37 </span><span class="caption-text">Record <strong>CONNE.1</strong>.</span><a class="headerlink" href="#tab-conne-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EL1</span></code>, <code class="docutils literal notranslate"><span class="pre">NE1</span></code></p></td>
<td><p>A3, I2</p></td>
<td><p>code name of the first element.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">EL2</span></code>, <code class="docutils literal notranslate"><span class="pre">NE2</span></code></p></td>
<td><p>A3, I2</p></td>
<td><p>code name of the second element.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NSEQ</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of additional connections in the sequence.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NAD1</span></code></p></td>
<td><p>I5</p></td>
<td><p>increment of the code number of the first element between two successive connections.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NAD2</span></code></p></td>
<td><p>I5</p></td>
<td><p>increment of the code number of the second element between two successive connections.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ISOT</span></code></p></td>
<td><p>I5</p></td>
<td><p>set equal to 1, 2, or 3; specifies absolute permeability to be <code class="docutils literal notranslate"><span class="pre">PER(ISOT)</span></code> for the materials in elements (<code class="docutils literal notranslate"><span class="pre">EL1</span></code>, <code class="docutils literal notranslate"><span class="pre">NE1</span></code>) and (<code class="docutils literal notranslate"><span class="pre">EL2</span></code>, <code class="docutils literal notranslate"><span class="pre">NE2</span></code>), where <code class="docutils literal notranslate"><span class="pre">PER</span></code> is read in block <strong>ROCKS</strong>. This allows assignment of different permeabilities, e.g., in the horizontal and vertical direction.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">D1</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>distance (m) from first element to interface.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">D2</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>distance (m) from second element to interface.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AREAX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>interface area (m<sup>2</sup>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">BETAX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>cosine of the angle between the gravitational acceleration vector and the line between the two elements. <code class="docutils literal notranslate"><span class="pre">GF</span></code> × <code class="docutils literal notranslate"><span class="pre">BETAX</span></code> &gt; 0 (&lt;0) corresponds to first element being above (below) the second element.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SIGX</span></code></p></td>
<td><p>E10.4</p></td>
<td><div class="line-block">
<div class="line">“radiant emittance” factor for radiative heat transfer, which for a perfectly “black” body is equal to 1. The rate of radiative heat transfer between the two grid blocks is</div>
</div>
<div class="math notranslate nohighlight" id="equation-eq-51">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-51" title="Link to this equation">#</a></span>\[G_{rad} = SIGX \times \sigma_0 \times AREAX \times \left( T_2^4 - T_1^4 \right)\]</div>
<div class="line-block">
<div class="line">where <span class="math notranslate nohighlight">\(\sigma_0\)</span> = 5.6687e-8 J/m<sup>2</sup> K<sup>4</sup> s is the Stefan-Boltzmann constant, and <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_1\)</span> are the absolute temperatures of the two grid blocks. <code class="docutils literal notranslate"><span class="pre">SIGX</span></code> may be entered as a negative number, in which case the absolute value will be used, and heat conduction at the connection will be suppressed. <code class="docutils literal notranslate"><span class="pre">SIGX</span></code> = 0 will result in no radiative heat transfer.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Repeat record <strong>CONNE.1</strong> for the number of connections desired.</p>
<p>A blank record closes the <strong>CONNE</strong> data block.
Alternatively, connection information may terminate on a record with <code class="docutils literal notranslate"><span class="pre">+++</span></code> typed in the first three columns, followed by element cross-referencing information.
This is the termination used when generating a <em>MESH</em> file with TOUGH3.</p>
</section>
<section id="gener">
<h3>GENER<a class="headerlink" href="#gener" title="Link to this heading">#</a></h3>
<p>Introduces sinks and/or sources.</p>
<table class="table table-center" id="tab-gener-1">
<caption><span class="caption-number">Table 38 </span><span class="caption-text">Record <strong>GENER.1</strong>.</span><a class="headerlink" href="#tab-gener-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EL</span></code>, <code class="docutils literal notranslate"><span class="pre">NE</span></code></p></td>
<td><p>A3, I2</p></td>
<td><p>code name of the element containing the sink/source.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SL</span></code>, <code class="docutils literal notranslate"><span class="pre">NS</span></code></p></td>
<td><p>A3, I2</p></td>
<td><p>code name of the sink/source. The first three characters are arbitrary, the last two characters must be numbers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NSEQ</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of additional sinks/sources with the same injection/production rate (not applicable for <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> = DELV).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NADD</span></code></p></td>
<td><p>I5</p></td>
<td><p>increment between the code numbers of two successive elements with identical sink/source.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NADS</span></code></p></td>
<td><p>I5</p></td>
<td><p>increment between the code numbers of two successive sinks/sources.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LTAB</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of points in table of generation rate versus time. Set 0 or 1 for constant generation rate. For wells on deliverability, <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> denotes the number of open layers, to be specified only for the bottommost layer.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TYPE</span></code></p></td>
<td><p>A4</p></td>
<td><div class="line-block">
<div class="line">specifies different options for fluid or heat production and injection. For example, different fluid components may be injected, the nature of which depends on the EOS module being used. Different options for considering wellbore flow effects may also be specified:</div>
<div class="line-block">
<div class="line">- HEAT: Introduces a heat sink/source</div>
<div class="line">- WATE: water</div>
<div class="line">- COM1: component 1</div>
<div class="line">- COM2: component 2</div>
<div class="line">- COM3: component 3</div>
<div class="line">- …</div>
<div class="line">- COMn: component n</div>
<div class="line">- MASS: mass production rate specified</div>
<div class="line">- DELV: well on deliverability, i.e., production occurs against specified bottomhole pressure. If well is completed in more than one layer, bottommost layer must be specified first, with number of layers given in <code class="docutils literal notranslate"><span class="pre">LTAB</span></code>. Subsequent layers must be given sequentially for a total number of <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> layers.</div>
<div class="line">- F— or f—: well on deliverability against specified wellhead pressure. By convention, when the first letter of a type specification is F or f, TOUGH3 will perform flowing wellbore pressure corrections using tabular data of flowing bottomhole pressure vs. flow rate and flowing enthalpy. The tabular data used for flowing wellbore correction must be generated by means of a wellbore simulator ahead of a TOUGH3 run as ASCII data of 80 characters per record, according to the format specifications below.</div>
</div>
</div>
<blockquote>
<div><div class="line-block">
<div class="line">The first record is an arbitrary title. The second record holds the number of flow rate and flowing enthalpy data (table points), <code class="docutils literal notranslate"><span class="pre">NG</span></code> and <code class="docutils literal notranslate"><span class="pre">NH</span></code>, respectively, in format 2I5; in <a class="reference internal" href="#table-6"><span class="std std-numref">Listing 3</span></a> we have <code class="docutils literal notranslate"><span class="pre">NG</span></code> = 11, <code class="docutils literal notranslate"><span class="pre">NH</span></code> = 9. This is followed by <code class="docutils literal notranslate"><span class="pre">NG</span></code> flow rate data in format 8E10.4, and <code class="docutils literal notranslate"><span class="pre">NH</span></code> enthalpy data also in format 8E10.4. After this come <code class="docutils literal notranslate"><span class="pre">NG</span></code> sets of <code class="docutils literal notranslate"><span class="pre">NH</span></code> flowing bottomhole pressure data in format 8E10.4. The data in <a class="reference internal" href="#table-6"><span class="std std-numref">Listing 3</span></a> were generated with the HOLA wellbore simulator (Aunzo et al., 1991) for a 0.2 m (≈8 inch) inside diameter well of 1,000 m feed zone depth with 7 bars wellhead pressure. Formation temperature for the conductive heat loss calculation in HOLA was assumed to increase linearly from 25˚C at the land surface to 275.5˚C at 750 m depth. Flow rates cover the range from 0.5 to 90.5 kg/s, and flowing enthalpies cover the range from 1,000 to 1,400 kJ/kg. A data record with very large bottomhole pressures of 55.55 MPa was added by hand for a very large hypothetical rate of 1,000 kg/s. This was done to avoid rates going out of table range during Newton-Raphson iteration in a TOUGH3 flow simulation.</div>
<div class="line">The data must be provided by means of a disk file, whose name consists of the four characters of the <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> specification, and the one character of the following <code class="docutils literal notranslate"><span class="pre">ITAB</span></code> parameter. For example, to use wellbore pressure data in a disk file called <em>f725d</em>, specify <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> as <em>f725</em>, and specify <code class="docutils literal notranslate"><span class="pre">ITAB</span></code> as <em>d</em>. Different wellbore tables, representing, e.g., wells with different diameter, feed zone depth, and flowing wellhead pressure, may be used simultaneously in a TOUGH3 simulation. Also, several wells completed in different grid blocks may reference the same wellbore table.</div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">The capability for flowing wellbore pressure correction is presently only available for wells with a single feed zone.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ITAB</span></code></p></td>
<td><p>A1</p></td>
<td><p>unless left blank, table of specific enthalpies will be read (<code class="docutils literal notranslate"><span class="pre">LTAB</span></code> &gt; 1 only). When time-dependent injection is used, <code class="docutils literal notranslate"><span class="pre">ITAB</span></code> must be specified non-blank, and specific enthalpy data must be given.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>constant generation rate; positive for injection, negative for production; <code class="docutils literal notranslate"><span class="pre">GX</span></code> is mass rate (kg/s) for generation types COM1, COM2, COM3, etc, and MASS; it is energy rate (J/s) for a HEAT sink/source. For wells on deliverability, <code class="docutils literal notranslate"><span class="pre">GX</span></code> is productivity index PI (m<sup>3</sup>), Eq. <a class="reference internal" href="governing_equations.html#equation-eq-16">(16)</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">EX</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>fixed specific enthalpy (J/kg) of the fluid for mass injection (<code class="docutils literal notranslate"><span class="pre">GX</span></code> &gt; 0). For wells on deliverability against fixed bottomhole pressure, <code class="docutils literal notranslate"><span class="pre">EX</span></code> is bottomhole pressure <span class="math notranslate nohighlight">\(P_{wb}\)</span> (Pa), at the center of the topmost producing layer in which the well is open.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">HG</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>thickness of layer (m; wells on deliverability with specified bottomhole pressure only).</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id21">
<span id="table-6"></span><div class="code-block-caption"><span class="caption-number">Listing 3 </span><span class="caption-text">Flowing bottomhole pressures (in Pa) at 1000 m feed zone depth for a well of 20 cm (≈8 inch) inside diameter producing at 7 bar wellhead pressure (calculated from HOLA; Aunzo et al., 1991).</span><a class="headerlink" href="#id21" title="Link to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>*f725d* - (q,h) from ( .5000E+00, .1000E+07) to ( .9050E+02, .1400E+07)
   11    9
 .5000E+00 .1050E+02 .2050E+02 .3050E+02 .4050E+02 .5050E+02 .6050E+02 .7050E+02
 .8050E+02 .9050E+02 1.e3
 .1000E+07 .1050E+07 .1100E+07 .1150E+07 .1200E+07 .1250E+07 .1300E+07 .1350E+07
 .1400E+07
 .1351E+07 .1238E+07 .1162E+07 .1106E+07 .1063E+07 .1028E+07 .9987E+06 .9740E+06
 .9527E+06
 .1482E+07 .1377E+07 .1327E+07 .1299E+07 .1284E+07 .1279E+07 .1279E+07 .1286E+07
 .1292E+07
 .2454E+07 .1826E+07 .1798E+07 .1807E+07 .1835E+07 .1871E+07 .1911E+07 .1954E+07
 .1998E+07
 .4330E+07 .3199E+07 .2677E+07 .2280E+07 .2322E+07 .2376E+07 .2434E+07 .2497E+07
 .2559E+07
 .5680E+07 .4772E+07 .3936E+07 .3452E+07 .2995E+07 .2808E+07 .2884E+07 .2967E+07
 .3049E+07
 .6658E+07 .5909E+07 .5206E+07 .4557E+07 .4158E+07 .3746E+07 .3391E+07 .3402E+07
 .3511E+07
 .7331E+07 .6850E+07 .6171E+07 .5627E+07 .5199E+07 .4814E+07 .4465E+07 .4208E+07
 .3957E+07
 .7986E+07 .7548E+07 .7140E+07 .6616E+07 .6256E+07 .5908E+07 .5634E+07 .5399E+07
 .5128E+07
 .8621E+07 .8177E+07 .7820E+07 .7560E+07 .7234E+07 .6814E+07 .6624E+07 .6385E+07
 .6254E+07
 .8998E+07 .8732E+07 .8453E+07 .8124E+07 .7925E+07 .7671E+07 .7529E+07 .7397E+07
 .7269E+07
 .5555e+08 .5555e+08 .5555e+08 .5555e+08 .5555e+08 .5555e+08 .5555e+08 .5555e+08
 .5555e+08
</pre></div>
</div>
</div>
<table class="table table-center" id="tab-gener-1-1">
<caption><span class="caption-number">Table 39 </span><span class="caption-text">Record <strong>GENER.1.1</strong> (optional, <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> &gt; 1 only).</span><a class="headerlink" href="#tab-gener-1-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">F1(L)</span></code></p></td>
<td><p>E14.7</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">L</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> generation times.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-gener-1-2">
<caption><span class="caption-number">Table 40 </span><span class="caption-text">Record <strong>GENER.1.2</strong> (optional, <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> &gt; 1 only).</span><a class="headerlink" href="#tab-gener-1-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">F2(L)</span></code></p></td>
<td><p>E14.7</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">L</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> specific enthalpy of produced or injected fluid.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-gener-1-3">
<caption><span class="caption-number">Table 41 </span><span class="caption-text">Record <strong>GENER.1.3</strong> (optional, <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> &gt; 1 and <code class="docutils literal notranslate"><span class="pre">ITAB</span></code> non-blank only; this data must be provided for injection at time-dependent rates).</span><a class="headerlink" href="#tab-gener-1-3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">F3(L)</span></code></p></td>
<td><p>E14.7</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">L</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> generation rates.</p></td>
</tr>
</tbody>
</table>
<p>Repeat records <strong>GENER.1</strong>, <strong>GENER.1.1</strong>, <strong>GENER.1.2</strong>, and <strong>GENER.1.3</strong> for the number of sinks/sources desired.</p>
<p>A blank record closes the <strong>GENER</strong> data block.
Alternatively, generation information may terminate on a record with <code class="docutils literal notranslate"><span class="pre">+++</span></code> typed in the first three columns, followed by element cross-referencing information.</p>
<p>In addition to the standard input format, time-dependent generation rates (i.e., if <code class="docutils literal notranslate"><span class="pre">LTAB</span></code> &gt; 1 in block <strong>GENER.1</strong>) can be provided as a free-format table with time in the first column, injection or production rate in the second column, and (if <code class="docutils literal notranslate"><span class="pre">ITAB</span></code> is not left blank) specific enthalpy in the third column.
The number of table rows is given by <code class="docutils literal notranslate"><span class="pre">LTAB</span></code>.
The tabular format is chosen by providing the character “T” or “D” in Column 7 after keyword <strong>GENER</strong>.
Moreover, time and rate conversion factors can be given in columns 11-20 and 21-30.
If character “D” is specified in Column 7, time can be given in (any) date format; it will be converted to seconds (relative to the first date given).
These conversion factors only apply to sinks/source with time-dependent generation rates (i.e., constant rates given in columns 41-50 of block
<strong>GENER.1</strong> are not affected).
The free-format options are only available if sinks/sources are given directly in the TOUGH3 input deck.
The external file <em>GENER</em> has to be provided in the standard format.</p>
</section>
<section id="timbc">
<h3>TIMBC<a class="headerlink" href="#timbc" title="Link to this heading">#</a></h3>
<p>Permits the users to specify time-dependent Dirichlet boundary conditions.
All values in this data block are read in free format.</p>
<table class="table table-center" id="tab-timbc-1">
<caption><span class="caption-number">Table 42 </span><span class="caption-text">Record <strong>TIMBC.1</strong>.</span><a class="headerlink" href="#tab-timbc-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NTPTAB</span></code></p></td>
<td><p>Free</p></td>
<td><p>number of elements with time-dependent boundary conditions.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-timbc-2">
<caption><span class="caption-number">Table 43 </span><span class="caption-text">Record <strong>TIMBC.2</strong>.</span><a class="headerlink" href="#tab-timbc-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NBCP</span></code></p></td>
<td><p>Free</p></td>
<td><p>number of times.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NBCPV</span></code></p></td>
<td><p>Free</p></td>
<td><p>number of primary variable that is time dependent, e.g., 1 for pressure.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-timbc-3">
<caption><span class="caption-number">Table 44 </span><span class="caption-text">Record <strong>TIMBC.3</strong>.</span><a class="headerlink" href="#tab-timbc-3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BCELM</span></code></p></td>
<td><p>Free</p></td>
<td><p>name of boundary element (start in Column 1).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-timbc-4">
<caption><span class="caption-number">Table 45 </span><span class="caption-text">Record <strong>TIMBC.4</strong>.</span><a class="headerlink" href="#tab-timbc-4" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIMBCV(I)</span></code>, <code class="docutils literal notranslate"><span class="pre">PGBCEL(I)</span></code></p></td>
<td><p>Free</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NBCP</span></code> times and values of primary variable <code class="docutils literal notranslate"><span class="pre">NBCPV</span></code> at boundary element <code class="docutils literal notranslate"><span class="pre">BCELM</span></code>.</p></td>
</tr>
</tbody>
</table>
<p>Repeat records <strong>TIMBC.2</strong>, <strong>TIMBC.3</strong>, and <strong>TIMBC.4</strong> for <code class="docutils literal notranslate"><span class="pre">NTPTAB</span></code> times.</p>
</section>
<section id="momop-optional">
<h3>MOMOP (optional)<a class="headerlink" href="#momop-optional" title="Link to this heading">#</a></h3>
<p>Describes additional options.</p>
<table class="table table-center" id="tab-momop">
<caption><span class="caption-number">Table 46 </span><span class="caption-text">Record <strong>MOMOP</strong>.</span><a class="headerlink" href="#tab-momop" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(1)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Minimum number of Newton-Raphson iterations:</div>
<div class="line">0, 1: Allow convergence in a single Newton-Raphson iteration</div>
<div class="line">2: Perform at least two iterations; primary variables are always updated</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(2)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Length of element names (default: 5 characters). Format of blocks <strong>ELEME</strong>, <strong>CONNE</strong>, <strong>INCON</strong>, and <strong>GENER</strong> change depending on element-name length as follows</div>
<div class="line"><br /></div>
<div class="line"><strong>ELEME</strong></div>
<div class="line">5: (A3,I2,I5,I5,A2,A3,6E10.4)</div>
<div class="line">6: (A3,I3,I5,I4,A2,A3,6E10.4)</div>
<div class="line">7: (A3,I4,I4,I4,A2,A3,6E10.4)</div>
<div class="line">8: (A3,I5,I4,I3,A2,A3,6E10.4)</div>
<div class="line">9: (A3,I6,I3,I3,A2,A3,6E10.4)</div>
<div class="line"><br /></div>
<div class="line"><strong>CONNE</strong></div>
<div class="line">5: (2(A3,I2),I5,2I5,I5,4E10.4)</div>
<div class="line">6: (2(A3,I3),I5,2I4,I5,4E10.4)</div>
<div class="line">7: (2(A3,I4),I5,2I3,I5,4E10.4)</div>
<div class="line">8: (2(A3,I5),I3,2I3,I5,4E10.4)</div>
<div class="line">9: (2(A3,I6),I3,2I2,I5,4E10.4)</div>
<div class="line"><br /></div>
<div class="line"><strong>INCON</strong></div>
<div class="line">5: (A3,I2,I5,I5,E15.8,4E12.4)</div>
<div class="line">6: (A3,I3,I5,I4,E15.8,4E12.4)</div>
<div class="line">7: (A3,I4,I4,I4,E15.8,4E12.4)</div>
<div class="line">8: (A3,I5,I4,I3,E15.8,4E12.4)</div>
<div class="line">9: (A3,I6,I3,I3,E15.8,4E12.4)</div>
<div class="line"><br /></div>
<div class="line"><strong>GENER</strong></div>
<div class="line">5: (A3,I2,A3,I2,I5,2I5,I5,5X,A4,A1,3E10.4)</div>
<div class="line">6: (A3,I3,A3,I2,I6,2I4,I5,5X,A4,A1,3E10.4)</div>
<div class="line">7: (A3,I4,A3,I2,I5,2I4,I5,5X,A4,A1,3E10.4)</div>
<div class="line">8: (A3,I5,A3,I2,I4,2I4,I5,5X,A4,A1,3E10.4)</div>
<div class="line">9: (A3,I6,A3,I2,I5,2I3,I5,5X,A4,A1,3E10.4)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(3)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Honoring generation times in block <strong>GENER</strong>:</div>
<div class="line">0: Generation times ignored</div>
<div class="line">&gt;0: Time steps adjusted to match generation times</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(4)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Vapor pressure reduction:</div>
<div class="line">0: No vapor pressure reduction at low liquid saturation</div>
<div class="line">&gt;0: Reduces vapor pressure for <span class="math notranslate nohighlight">\(S_l\)</span> &lt; 0.02 to prevent liquid disappearance by evaporation (only certain EOS modules)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(5)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Active Fracture Model:</div>
<div class="line">0: Active Fracture Model applied to liquid phase only</div>
<div class="line">&gt;0: Active Fracture Model applied to all phases</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(6)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Leverett scaling of capillary pressure:</div>
<div class="line">0: No Leverett scaling</div>
<div class="line">&gt;0: Rescale capillary pressure: <span class="math notranslate nohighlight">\(P_c = P_{c, ref} \sqrt{\frac{k_{ref}}{k}}\)</span> if element-specific permeabilities are specified</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(7)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Zero nodal distance:</div>
<div class="line">0: Take absolute permeability from other element</div>
<div class="line">&gt;0: Take absolute and relative permeability from other element</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(8)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Conversion of element names:</div>
<div class="line">0: No conversion</div>
<div class="line">&gt;0: Convert non-leading spaces in element names to zeros</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(9)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Time stepping after time-step reduction to honor printout time:</div>
<div class="line">0: Continue with time step used before forced time-step reduction</div>
<div class="line">&gt;0: Continue with time step imposed by forced time-step reduction</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(10)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Writing <em>SAVE</em> file:</div>
<div class="line">0: Write <em>SAVE</em> file only at the end of a forward run</div>
<div class="line">1: Write <em>SAVE</em> file after each printout time</div>
<div class="line">2: Write separate <em>SAVE</em> files after each printout time</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(11)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Water properties:</div>
<div class="line">0: International Formulation Committee (1967)</div>
<div class="line">1: IAPWS-IF97</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(12)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Enthalpy of liquid water:</div>
<div class="line">0: Potential energy not included in enthalpy of liquid water</div>
<div class="line">&gt;0: Potential energy included in enthalpy of all phases (Stauffer et al., 2014)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(13)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Adjustment of Newton-Raphson increment weighting:</div>
<div class="line">0: No adjustment</div>
<div class="line">&gt;0: Reduce <code class="docutils literal notranslate"><span class="pre">WNR</span></code> by <code class="docutils literal notranslate"><span class="pre">MOP2(13)</span></code> percent if Newton-Raphson iterations oscillate and time step is reduced because <code class="docutils literal notranslate"><span class="pre">ITER</span></code> = <code class="docutils literal notranslate"><span class="pre">NOITE</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(14)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Print input file to the end of output file:</div>
<div class="line">0: Do not reprint input files</div>
<div class="line">1: Print TOUGH3 input file to the end of TOUGH3 output file</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(15)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Porosity used for calculation of rock energy content:</div>
<div class="line">0: Use porosity of block <strong>ROCKS</strong>; this assumes that the porosities provided in block <strong>INCON</strong> were the result of a pore compressibility/expansivity calculation; the “original” porosity from block <strong>ROCKS</strong> is used to compensate for equivalent rock-grain density changes</div>
<div class="line">&gt;0: Use porosity from block <strong>INCON</strong>; this assumes that these porosities were not the result from a pore compressibility/expansivity calculation; changes in rock-grain density due to pore compressibility/expansivity are not compensated.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(16)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Porosity-permeability relationships for heterogeneous media:</div>
<div class="line">0: No deterministic correlation</div>
<div class="line">1: Material-specific empirical correlations (see subroutine <em>PER2POR</em>)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(17)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Variables printed on <em>FOFT</em> files:</div>
<div class="line">0: Print variables according to input data in block <strong>FOFT</strong></div>
<div class="line">1: Print variables according to input data in block <strong>OUTPU</strong></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(18)</span></code></p></td>
<td><p>I1</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(19)</span></code></p></td>
<td><p>I1</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(20)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Reading anisotropic permeability modifiers in block <strong>ELEME</strong>:</div>
<div class="line">0: Read isotropic permeability modifiers from columns 41-50</div>
<div class="line">1: Read anisotropic permeability modifiers from columns 81-110</div>
<div class="line">2: Read anisotropic permeability modifiers for <code class="docutils literal notranslate"><span class="pre">ISOT</span></code> = 1 from columns 41-50 and for <code class="docutils literal notranslate"><span class="pre">ISOT</span></code> = 2 and 3 from columns 91-110</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(21)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Honoring generation times in blocks <strong>TIMBC</strong>:</div>
<div class="line">0: Time stepping ignores times specified in block <strong>TIMBC</strong></div>
<div class="line">&gt;0: Time steps adjusted to match times in block <strong>TIMBC</strong></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(22)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Format for reading coordinates in block <strong>ELEME</strong>:</div>
<div class="line">0: Read coordinates in format 3E10.4 from columns 51-80</div>
<div class="line">&gt;0: Read coordinates in format 3E20.14 from columns 51-110</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(23)</span></code></p></td>
<td><p>I1</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(24)</span></code></p></td>
<td><p>I1</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(25)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Check mesh for duplicate element names:</div>
<div class="line">0: Do not check the mesh</div>
<div class="line">1: Check the mesh</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(26)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Printout format:</div>
<div class="line">0: Both traditional output and CSV formats</div>
<div class="line">1: CSV/TECPLOT format (types separated; times combined)</div>
<div class="line">2: CSV/TECPLOT format (types separated; times separated)</div>
<div class="line">3: CSV/TECPLOT format (types combined; times combined)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOP2(27)</span></code></p></td>
<td><p>I1</p></td>
<td><div class="line-block">
<div class="line">Element naming in MESHMAKER:</div>
<div class="line">0: Traditional element naming scheme</div>
<div class="line">1: Element name is equal to consecutive element number</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="outpu-optional">
<h3>OUTPU (optional)<a class="headerlink" href="#outpu-optional" title="Link to this heading">#</a></h3>
<p>Permits the users to obtain printout of specified variables.
<strong>OUTPU</strong> specifications will supersede the default condition specified in <code class="docutils literal notranslate"><span class="pre">KDATA</span></code> in data block <strong>PARAM</strong>.
Block <strong>OUTPU</strong> must be specified after block <strong>MULTI</strong>.</p>
<table class="table table-center" id="tab-outpu-0">
<caption><span class="caption-number">Table 47 </span><span class="caption-text">Record <strong>OUTPU.0</strong>.</span><a class="headerlink" href="#tab-outpu-0" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">COUTFM</span></code></p></td>
<td><p>A20</p></td>
<td><p>a keyword indicating the desired output format, currently either CSV, TECPLOT, or PETRASIM.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-outpu-1">
<caption><span class="caption-number">Table 48 </span><span class="caption-text">Record <strong>OUTPU.1</strong>.</span><a class="headerlink" href="#tab-outpu-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MOUTVAR</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of variables to be printed out.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-outpu-2">
<caption><span class="caption-number">Table 49 </span><span class="caption-text">Record <strong>OUTPU.2</strong>.</span><a class="headerlink" href="#tab-outpu-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">COUTLN</span></code></p></td>
<td><p>A20</p></td>
<td><p>name of variable, to be chosen among the available options. They include primary variables, secondary parameters, flow terms, and more. The name of variables is all capital letters, and should be typed in the input file as shown in <a class="reference internal" href="#tab-8"><span class="std std-numref">Table 50</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ID1</span></code></p></td>
<td><p>I5</p></td>
<td><p>first option for the corresponding keyword in <code class="docutils literal notranslate"><span class="pre">COUTLN</span></code>, as shown in <a class="reference internal" href="#tab-8"><span class="std std-numref">Table 50</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ID2</span></code></p></td>
<td><p>I5</p></td>
<td><p>second option for the corresponding keyword in <code class="docutils literal notranslate"><span class="pre">COUTLN</span></code>, as shown in <a class="reference internal" href="#tab-8"><span class="std std-numref">Table 50</span></a>.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-8">
<caption><span class="caption-number">Table 50 </span><span class="caption-text">Keywords of block <strong>OUTPU</strong> and related output variables.</span><a class="headerlink" href="#tab-8" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 40.0%" />
<col style="width: 10.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>ID1</p></th>
<th class="head"><p>ID2</p></th>
<th class="head"><p>Output variable</p></th>
<th class="head"><p>Header</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SET</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ISET</span></code></p></td>
<td></td>
<td><div class="line-block">
<div class="line">Prints predefined sets of output variables:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISET</span></code> = 1: Set of main element-related output variables</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISET</span></code> = 2: Set of main connection-related output variables</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISET</span></code> = 3: Set of main generation-related output variables</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p>NO COMMA</p></td>
<td></td>
<td></td>
<td><p>Omit commas between values</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>NO QUOTES</p></td>
<td></td>
<td></td>
<td><p>Omit quotes around values</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>NO NAME</p></td>
<td></td>
<td></td>
<td><p>Omit element names</p></td>
<td></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">COORDINATE</div>
<div class="line">COORD</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code></p></td>
<td></td>
<td><div class="line-block">
<div class="line">Grid-block or connection coordinates; mesh dimension and orientation are automatically determined, or can be specified through variable <code class="docutils literal notranslate"><span class="pre">NXYZ</span></code>:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code> = 1 : Mesh is 1D “X  “</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code> = 2 : Mesh is 1D “ Y “</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code> = 3 : Mesh is 1D “ Z “</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code> = 4 : Mesh is 2D “XY “</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code> = 5 : Mesh is 2D “X Z”</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code> = 6 : Mesh is 2D “ YZ”</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NXYZ</span></code> = 7 : Mesh is 3D “XYZ”</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p>INDEX</p></td>
<td></td>
<td></td>
<td><p>Index (running number) of elements, connections, or sinks/sources</p></td>
<td></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">MATERIAL</div>
<div class="line">ROCK</div>
<div class="line">ROCK TYPE</div>
</div>
</td>
<td></td>
<td></td>
<td><p>Material number</p></td>
<td><p>ROCK</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">MATERIAL NAME</div>
<div class="line">ROCK NAME</div>
<div class="line">ROCK TYPE NAME</div>
</div>
</td>
<td></td>
<td></td>
<td><p>Material name</p></td>
<td><p>ROCK</p></td>
</tr>
<tr class="row-even"><td><p>ABSOLUTE</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ISOT</span></code></p></td>
<td></td>
<td><p>Absolute permeability in direction <code class="docutils literal notranslate"><span class="pre">ISOT</span></code>; if <code class="docutils literal notranslate"><span class="pre">ISOT</span></code> = 0, permeabilities related to all three directions are printed</p></td>
<td><p>ABS</p></td>
</tr>
<tr class="row-odd"><td><p>POROSITY</p></td>
<td></td>
<td></td>
<td><p>Porosity</p></td>
<td><p>POR</p></td>
</tr>
<tr class="row-even"><td><p>TEMPERATURE</p></td>
<td></td>
<td></td>
<td><p>Temperature</p></td>
<td><p>TEMP</p></td>
</tr>
<tr class="row-odd"><td><p>PRESSURE</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Pressure of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>PRES</p></td>
</tr>
<tr class="row-even"><td><p>SATURATION</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Saturation of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>SAT</p></td>
</tr>
<tr class="row-odd"><td><p>RELATIVE</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Relative permeability of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>REL</p></td>
</tr>
<tr class="row-even"><td><p>VISCOSITY</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Viscosity of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>VIS</p></td>
</tr>
<tr class="row-odd"><td><p>DENSITY</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Density of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>DEN</p></td>
</tr>
<tr class="row-even"><td><p>ENTHALPY</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Enthalpy of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>ENT</p></td>
</tr>
<tr class="row-odd"><td><p>CAPILLARY</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><div class="line-block">
<div class="line">Capillary pressure:</div>
<div class="line">if <code class="docutils literal notranslate"><span class="pre">IPH</span></code> = 1, difference between gas and aqueous phase pressures (for ECO2M, difference between gaseous CO<sub>2</sub> and aqueous phase pressures)</div>
<div class="line">if <code class="docutils literal notranslate"><span class="pre">IPH</span></code> = 2, difference between gas-NAPL phase pressures for TMVOC, and difference between gaseous and liquid CO<sub>2</sub> phase pressures for ECO2M</div>
</div>
</td>
<td><p>PCAP</p></td>
</tr>
<tr class="row-even"><td><p>MASS FRACTION</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IC</span></code></p></td>
<td><p>Mass fraction of component <code class="docutils literal notranslate"><span class="pre">IC</span></code> in phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>X1, X2, …</p></td>
</tr>
<tr class="row-odd"><td><p>DIFFUSION1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Diffusion parameter group 1 <span class="math notranslate nohighlight">\(\left( \phi \tau_0 \tau_{\beta} \rho_{\beta} \right)\)</span> of phase <span class="math notranslate nohighlight">\(\beta\)</span> = <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>DIFF1</p></td>
</tr>
<tr class="row-even"><td><p>DIFFUSION2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Diffusion parameter group 2 <span class="math notranslate nohighlight">\(\left( \frac{P_0}{P} \left( \frac{T + 273.15}{273.15} \right)^{\theta} \right)\)</span> of phase <span class="math notranslate nohighlight">\(\beta\)</span> = <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>DIFF2</p></td>
</tr>
<tr class="row-odd"><td><p>PSAT</p></td>
<td></td>
<td></td>
<td><p>Saturated vapor pressure</p></td>
<td><p>PSAT</p></td>
</tr>
<tr class="row-even"><td><p>BIOMASS</p></td>
<td></td>
<td></td>
<td><p>Biomass concentration</p></td>
<td><p>BIO</p></td>
</tr>
<tr class="row-odd"><td><p>PRIMARY</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPV</span></code></p></td>
<td></td>
<td><p>Primary variable No. <code class="docutils literal notranslate"><span class="pre">IPV</span></code>; if <code class="docutils literal notranslate"><span class="pre">IPV</span></code> = 0, all <code class="docutils literal notranslate"><span class="pre">NK</span></code> + 1 primary variables are printed</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>SECONDARY</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ISP</span></code></p></td>
<td><div class="line-block">
<div class="line">Secondary parameter No. <code class="docutils literal notranslate"><span class="pre">ISP</span></code> related to phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code>, where</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 0: All secondary parameters</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 1: Phase saturation</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 2: Relative permeability</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 3: Viscosity</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 4: Density</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 5: Enthalpy</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 6: Capillary pressure</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 7: Diffusion parameter group 1</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ISP</span></code> = 8: Diffusion parameter group 2</div>
</div>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">TOTAL FLOW</div>
<div class="line">TOTAL FLOW RATE</div>
</div>
</td>
<td></td>
<td></td>
<td><p>Total flow rate</p></td>
<td><p>FLOW</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">FLOW</div>
<div class="line">RATE</div>
<div class="line">FLOW RATE</div>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IC</span></code></p></td>
<td><div class="line-block">
<div class="line">Advective flow rate:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> = 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> = 0: Total flow</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> = 0: Flow of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &lt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> = 0: Flow of each phase</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> &gt; 0: Flow of component <code class="docutils literal notranslate"><span class="pre">IC</span></code> in phase <code class="docutils literal notranslate"><span class="pre">IPV</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> &lt; 0: The flow of each component in phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></div>
</div>
</td>
<td><p>FLOW</p></td>
</tr>
<tr class="row-odd"><td><p>DIFFUSIVE FLOW</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IC</span></code></p></td>
<td><div class="line-block">
<div class="line">Diffusive flow rate:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> = 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> = 0: Total flow</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> = 0: Flow of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &lt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> = 0: Flow of each phase</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> &gt; 0: Flow of component <code class="docutils literal notranslate"><span class="pre">IC</span></code> in phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">IPH</span></code> &gt; 0; <code class="docutils literal notranslate"><span class="pre">IC</span></code> &lt; 0: The flow of each component in phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></div>
</div>
</td>
<td><p>FDIFF</p></td>
</tr>
<tr class="row-even"><td><p>HEAT FLOW</p></td>
<td></td>
<td></td>
<td><p>Heat flow rate</p></td>
<td><p>HEAT</p></td>
</tr>
<tr class="row-odd"><td><p>VELOCITY</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IPH</span></code>†</p></td>
<td></td>
<td><p>Flow velocity of phase <code class="docutils literal notranslate"><span class="pre">IPH</span></code></p></td>
<td><p>VEL</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">GENERATION</div>
<div class="line">GENERATION RATE</div>
</div>
</td>
<td></td>
<td></td>
<td><p>Production or injection rate</p></td>
<td><p>GEN</p></td>
</tr>
<tr class="row-odd"><td><p>FLOWING ENTHALPY</p></td>
<td></td>
<td></td>
<td><p>Flowing enthalpy</p></td>
<td><p>ENTG</p></td>
</tr>
<tr class="row-even"><td><p>WELLBORE PRESSURE</p></td>
<td></td>
<td></td>
<td><p>Wellbore pressure (wells on deliverability only)</p></td>
<td><p>PWB</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>† If <code class="docutils literal notranslate"><span class="pre">IPH</span></code> = 0, the output variables of all phases are printed.</p>
</div>
</section>
<section id="endcy">
<h3>ENDCY<a class="headerlink" href="#endcy" title="Link to this heading">#</a></h3>
<p>Closes the TOUGH3 input file and initiates the simulation.</p>
</section>
</section>
<section id="geometry-data">
<span id="id8"></span><h2>Geometry Data<a class="headerlink" href="#geometry-data" title="Link to this heading">#</a></h2>
<section id="general-concepts">
<h3>General concepts<a class="headerlink" href="#general-concepts" title="Link to this heading">#</a></h3>
<p>Flow geometry in TOUGH3 is defined by means of a list of volume elements (“grid blocks”) and a list of flow connections between them, as in other “integral finite difference” codes (<span id="id9"><a class="reference internal" href="../references.html#id61" title="Narasimhan, T., &amp; Witherspoon, P. (1976). An integrated finite difference method for analyzing fluid flow in porous media. Water Resources Research, 12(1), 57–64.">Narasimhan &amp; Witherspoon, 1976</a></span>).
This formulation can handle regular and irregular flow geometries in one, two, and three dimensions.
Single- and multiple-porosity systems (porous and fractured media) can be specified, and higher-order methods, such as seven- and nine-point differencing, can be implemented by means of appropriate specification of geometric data (<span id="id10"><a class="reference internal" href="../references.html#id87" title="Pruess, K., &amp; Bodvarsson, F. (1983). A seven-point finite difference method for improved grid orientation performance in pattern steamfloods. SPE Reservoir Simulation Symposium.">Pruess &amp; Bodvarsson, 1983</a></span>).</p>
<p>In TOUGH3, volume elements are identified by names that consist of a string of by default five characters, <code class="docutils literal notranslate"><span class="pre">12345</span></code>, unless a different length of element names is specified in data block
MOMOP (<code class="docutils literal notranslate"><span class="pre">MOP2(2)</span></code> &gt; 5).
These are arbitrary, except that the last two characters (#4 and 5) must be numbers if grids are generated using <code class="docutils literal notranslate"><span class="pre">NSEQ</span></code> in data block <strong>ELEME</strong> and <strong>CONNE</strong>; an example of a valid element name is “<code class="docutils literal notranslate"><span class="pre">ELE10</span></code>”.
Flow connections are specified as ordered pairs of elements, such as “(<code class="docutils literal notranslate"><span class="pre">ELE10</span></code>, <code class="docutils literal notranslate"><span class="pre">ELE11</span></code>)”.
A variety of options and facilities are available for entering and processing geometric data (see <a class="reference internal" href="#fig-8"><span class="std std-numref">Figure 4</span></a>).
Element volumes and domain identification can be provided by means of a data block <strong>ELEME</strong> in the input file, while a data block <strong>CONNE</strong> can be used to supply connection data, including interface area, nodal distances from the interface, and orientation of the nodal line relative to the vertical.
These data are internally written to a disk file <em>MESH</em>, which in turn initializes the geometry data arrays used during the flow simulation.
It is also possible to omit the <strong>ELEME</strong> and <strong>CONNE</strong> data blocks from the input file, and provide geometry data directly on a disk file <em>MESH</em>.</p>
<figure class="align-center" id="fig-8">
<a class="reference internal image-reference" href="../../_images/figure_8.png"><img alt="../../_images/figure_8.png" src="../../_images/figure_8.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 4 </span><span class="caption-text">User options for supplying geometry data.</span><a class="headerlink" href="#fig-8" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="meshmaker">
<h3>Meshmaker<a class="headerlink" href="#meshmaker" title="Link to this heading">#</a></h3>
<p>TOUGH3 offers an additional way for defining flow system geometry by means of a special program module MESHMaker.
This can perform a number of mesh generation and processing operations and is invoked with the keyword <strong>MESHM</strong> in the input file (see <a class="reference internal" href="#fig-9"><span class="std std-numref">Figure 5</span></a>).
The MESHMaker module has a modular structure.
At the present time, there are three sub-modules available in MESHMaker: keywords RZ2D or RZ2DL invoke generation of a one or two-dimensional radially symmetric R-Z mesh; XYZ initiates generation of a one, two, or three dimensional Cartesian X-Y-Z mesh; and MINC calls a modified version of the <em>GMINC</em> program (<span id="id11"><a class="reference internal" href="../references.html#id79" title="Pruess, K. (1983). GMINC: A mesh generator for flow simulations in fractured reservoirs. Lawrence Berkeley Lab., CA (USA).">Pruess, 1983</a></span>) to sub-partition a primary porous medium mesh into a secondary mesh for fractured media, using the method of “multiple interacting continua” (<span id="id12"><a class="reference internal" href="../references.html#id88" title="Pruess, K., &amp; Narasimhan, T. (1985). A practical method for modeling fluid and heat flow in fractured porous media. Society of Petroleum Engineers Journal, 25(01), 14–26.">Pruess &amp; Narasimhan, 1985</a></span>), which will be described in detail below.</p>
<p>Several naming conventions for the elements created with keywords RZ2D (or RZ2DL) and XYZ have been adopted in the internal mesh generation process.
In addition to the traditional TOUGH2 conventions, the other conventions are adopted to accommodate large numbers of grid blocks in cases with <code class="docutils literal notranslate"><span class="pre">MOP2(2)</span></code> &gt; 5 or <code class="docutils literal notranslate"><span class="pre">MOP2(27)</span></code> &gt; 0.
Both RZ2D and XYZ assign all grid blocks to domain #1 (first entry in block <strong>ROCKS</strong>); a user desiring changes in domain assignments must do so by hand, either through editing of the <em>MESH</em> file with a text editor, or by means of preprocessing with an appropriate utility program, or by appropriate source code changes in subroutines <em>WRZ2D</em> and <em>GXYZ</em>.
TOUGH3 runs that involve RZ2D or XYZ mesh generation will produce a special printout, showing element names arranged in their actual geometric pattern.</p>
<p>The naming conventions for the MINC process are as follows.
For a primary grid block with name <code class="docutils literal notranslate"><span class="pre">12345</span></code>, the corresponding fracture subelement in the secondary mesh is named <code class="docutils literal notranslate"><span class="pre">12345</span></code> (character #1 replaced with a blank for easy recognition).
The successive matrix continua are labeled by running character #1 through 2, …, 9, A, B, …, Z.
The domain assignment is incremented by 1 for the fracture grid blocks, and by 2 for the matrix grid blocks.
Thus, domain assignments in data block <strong>ROCKS</strong> should be provided in the following order: the first entry is the single (effective) porous medium, then follows the effective fracture continuum, and then the rock matrix.
Users should be aware that the MINC process may lead to ambiguous element names when the inactive element device is used to keep a portion of the primary mesh as unprocessed porous medium.
Also, the MINC process may generate duplicate element names. TOUGH3 will check the element names after reading disk file <em>MESH</em>, and abort the simulation if duplicate element names are found.</p>
<figure class="align-center" id="fig-9">
<a class="reference internal image-reference" href="../../_images/figure_9.png"><img alt="../../_images/figure_9.png" src="../../_images/figure_9.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5 </span><span class="caption-text">MESHMaker input formats.</span><a class="headerlink" href="#fig-9" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As a convenience for users desiring graphical display of data, the internal mesh generation process will also write nodal point coordinates on file MESH.
By default these data are written in 3E10.4 format into columns 51-80 of each grid block entry in data block <strong>ELEME</strong>, unless a longer effective digit of 3E20.14 format into columns 51-110 is specified in data block <strong>MOMOP</strong> (<code class="docutils literal notranslate"><span class="pre">MOP2(22)</span></code> &gt; 0).
No internal use is made of nodal point coordinates in TOUGH3, except for optional initialization of a gravity-capillary equilibrium with EOS9 (see the addendum for EOS9) and for optional addition of potential energy to enthalpy with <code class="docutils literal notranslate"><span class="pre">MOP2(12)</span></code> &gt; 0 in data block <strong>MOMOP</strong>.</p>
<p>Mesh generation and/or MINC processing can be performed as part of a simulation run.
Alternatively, by closing the input file with the keyword <strong>ENDFI</strong> (instead of <strong>ENDCY</strong>), it is possible
to skip the flow simulation and only execute the MESHMaker module to generate a <em>MESH</em> or <em>MINC</em> file.
These files can then be used, with additional user-modifications by hand if desired, in subsequent flow simulations.
Execution of MESHMaker produces printed output which is self-explanatory.</p>
</section>
<section id="multiple-porosity-processing">
<h3>Multiple-porosity processing<a class="headerlink" href="#multiple-porosity-processing" title="Link to this heading">#</a></h3>
<p>Multiple-porosity processing for simulation of flow in naturally fractured reservoirs can be invoked by means of a keyword MINC, which stands for “multiple interacting continua” (<span id="id13"><a class="reference internal" href="../references.html#id88" title="Pruess, K., &amp; Narasimhan, T. (1985). A practical method for modeling fluid and heat flow in fractured porous media. Society of Petroleum Engineers Journal, 25(01), 14–26.">Pruess &amp; Narasimhan, 1985</a></span>).
The MINC-process operates on the data of the primary (porous medium) mesh as provided on disk file <em>MESH</em>, and generates a “secondary” mesh containing fracture and matrix elements with identical data formats on file <em>MINC</em>.
By appropriate subgridding of the matrix blocks, as shown in <a class="reference internal" href="#fig-10"><span class="std std-numref">Figure 6</span></a>, and therefore by resolving the driving pressure, temperature, and mass fraction gradients at the matrix and fracture interface, the transient, multiphase interporosity flows between rock matrix and fractures can accurately be described.
The MINC concept is based on the notion that changes in fluid pressures, temperatures, phase compositions, etc, due to the presence of sinks and sources (production and injection wells) will propagate rapidly through the fracture system, while invading the tight matrix blocks only slowly.
Therefore, changes in matrix conditions will (locally) be controlled by the distance from the fractures.
Fluid and heat flow from the fractures into the matrix blocks, or from the matrix blocks into the fractures, can then be modeled by means of one-dimensional strings of nested grid blocks, as shown in <a class="reference internal" href="#fig-10"><span class="std std-numref">Figure 6</span></a>.
The MINC-method lumps all fractions within a certain reservoir subdomain into continuum #1, all matrix material within a certain distance from the fractures into continuum #2, matrix material at larger distance into continuum #3, and so on.
Quantitatively, the subgridding is specified by means of a set of volume fractions, into which the primary porous medium grid blocks are partitioned.
The MINC-process in the MESHMaker module operates on the element and connection data of a porous medium mesh to calculate, for given data on volume fractions, the volumes, interface areas, and nodal distances for a secondary fractured medium mesh.
The information on fracturing (spacing, number of sets, shape of matrix blocks) required for this is provided by a “proximity function” PROX(x) which expresses, for a given reservoir domain <span class="math notranslate nohighlight">\(V_0\)</span>, the total fraction of matrix material within a distance <span class="math notranslate nohighlight">\(x\)</span> from the fractures.
If only two continua are specified (one for fractures, one for matrix), the MINC approach reduces to the conventional double-porosity method (<span id="id14"><a class="reference internal" href="../references.html#id114" title="Warren, J., &amp; Root, P. J. (1963). The behavior of naturally fractured reservoirs. Society of Petroleum Engineers Journal, 3(03), 245–255.">Warren &amp; Root, 1963</a></span>).
Full details are given in a separate report (<span id="id15"><a class="reference internal" href="../references.html#id79" title="Pruess, K. (1983). GMINC: A mesh generator for flow simulations in fractured reservoirs. Lawrence Berkeley Lab., CA (USA).">Pruess, 1983</a></span>).
For any given fractured reservoir flow problem, selection of the most appropriate gridding scheme must be based on a careful consideration of the physical and geometric conditions of flow.
The MINC approach is not applicable to systems in which fracturing is so sparse that the fractures cannot be approximated as a continuum.</p>
<figure class="align-center" id="fig-10">
<a class="reference internal image-reference" href="../../_images/figure_10.png"><img alt="../../_images/figure_10.png" src="../../_images/figure_10.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 6 </span><span class="caption-text">Subgridding in the method of “multiple interacting continua” (MINC).</span><a class="headerlink" href="#fig-10" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The file <em>MESH</em> used in this process can be either directly supplied by the user, or it can have been internally generated either from data in input blocks <strong>ELEME</strong> and <strong>CONNE</strong>, or from RZ2D or XYZ mesh- making.
The MINC process of sub-partitioning porous medium grid blocks into fracture and matrix continua will only operate on active grid blocks, while inactive grid blocks are left unchanged as single porous medium blocks.
In TOUGH3, elements in data block <strong>ELEME</strong> (or file <em>MESH</em>) are taken to be “active” unless they have very large volumes, which are taken to be “inactive”.
In order to exclude selected reservoir domains from the MINC process and make them remain single porous media, the user needs to change the volume of the corresponding blocks to a very large number before MINC partitioning is made.
Note that here the concept of inactive blocks is used in an unrelated manner with respect to the one to maintain time-independent Dirichlet boundary conditions (see Section <a class="reference internal" href="initial_and_boundary_conditions.html#initial-and-boundary-conditions"><span class="std std-ref">Initial and Boundary Conditions</span></a>).</p>
</section>
</section>
<section id="input-formats-for-meshmaker">
<span id="id16"></span><h2>Input Formats for MESHMAKER<a class="headerlink" href="#input-formats-for-meshmaker" title="Link to this heading">#</a></h2>
<section id="generation-of-radially-symmetric-grid">
<h3>Generation of radially symmetric grid<a class="headerlink" href="#generation-of-radially-symmetric-grid" title="Link to this heading">#</a></h3>
<p>Keyword RZ2D (or RZ2DL) invokes generation of a radially symmetric mesh.
Nodal points will be placed half-way between neighboring radial interfaces.
When RZ2D is specified, the mesh will be generated by columns; i.e., in the <strong>ELEME</strong> block we will first have the grid blocks at
smallest radius for all layers, then the next largest radius for all layers, and so on.
With keyword RZ2DL the mesh will be generated by layers; i.e., in the <strong>ELEME</strong> block we will first have all grid blocks for the first (top) layer from smallest to largest radius, then all grid blocks for the second layer, and so on.
Apart from the different ordering of elements, the two meshes for RZ2D and RZ2DL are identical.
The reason for providing the two alternatives is as a convenience to users in implementing boundary conditions by way of inactive elements (see Section <a class="reference internal" href="initial_and_boundary_conditions.html#initial-and-boundary-conditions"><span class="std std-ref">Initial and Boundary Conditions</span></a>).
RZ2D makes it easy to declare a vertical column inactive, facilitating assignment of boundary conditions in the vertical, such as a gravitationally equilibrated pressure gradient.
RZ2DL on the other hand facilitates implementation of areal (top and bottom layer) boundary conditions.</p>
<section id="radii">
<h4>RADII<a class="headerlink" href="#radii" title="Link to this heading">#</a></h4>
<p>RADII is the first keyword following RZ2D; it introduces data for defining a set of interfaces (grid block boundaries) in the radial direction.</p>
<table class="table table-center" id="tab-radii-1">
<caption><span class="caption-number">Table 51 </span><span class="caption-text">Record <strong>RADII.1</strong>.</span><a class="headerlink" href="#tab-radii-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NRAD</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of radius data that will be read. At least one radius must be provided, indicating the inner boundary of the mesh.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-radii-2">
<caption><span class="caption-number">Table 52 </span><span class="caption-text">Record <strong>RADII.2</strong>.</span><a class="headerlink" href="#tab-radii-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RC(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NRAD</span></code> radii in ascending order.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="equid">
<h4>EQUID<a class="headerlink" href="#equid" title="Link to this heading">#</a></h4>
<p>Introduces data on a set of equal radial increments.</p>
<table class="table table-center" id="tab-equid-1">
<caption><span class="caption-number">Table 53 </span><span class="caption-text">Record <strong>EQUID.1</strong>.</span><a class="headerlink" href="#tab-equid-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NEQU</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of desired radial increments.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DR</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>number of desired radial increments.</p></td>
</tr>
</tbody>
</table>
<p>Note that at least one radius must have been defined via block RADII before EQUID can be invoked.</p>
</section>
<section id="logar">
<h4>LOGAR<a class="headerlink" href="#logar" title="Link to this heading">#</a></h4>
<p>Introduces data on radial increments that increase from one to the next by the same factor (<span class="math notranslate nohighlight">\(\Delta R_{n + 1} = f \cdot \Delta R_n\)</span>).</p>
<table class="table table-center" id="tab-logar-1">
<caption><span class="caption-number">Table 54 </span><span class="caption-text">Record <strong>LOGAR.1</strong>.</span><a class="headerlink" href="#tab-logar-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NLOG</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of additional interface radii desired.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RLOG</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>desired radius of the last (largest) of these radii.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DR</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>reference radial increment: the first <span class="math notranslate nohighlight">\(\Delta R\)</span> generated will be equal to f × <code class="docutils literal notranslate"><span class="pre">DR</span></code>, with f internally determined such that the last increment will bring total radius to <code class="docutils literal notranslate"><span class="pre">RLOG</span></code>. f &lt; 1 for decreasing radial increments is permissible. If <code class="docutils literal notranslate"><span class="pre">DR</span></code> is set equal to zero, or left blank, the last increment <code class="docutils literal notranslate"><span class="pre">DR</span></code> generated before keyword LOGAR will be used as default.</p></td>
</tr>
</tbody>
</table>
<p>Additional blocks RADII, EQUID, and LOGAR can be specified in arbitrary order.
Note that at least one radius must have been defined before LOGAR can be invoked.
If <code class="docutils literal notranslate"><span class="pre">DR</span></code> = 0, at least two radii must have been defined.</p>
</section>
<section id="layer">
<h4>LAYER<a class="headerlink" href="#layer" title="Link to this heading">#</a></h4>
<p>Introduces information on horizontal layers, and signals closure of RZ2D input data.</p>
<table class="table table-center" id="tab-layer-1">
<caption><span class="caption-number">Table 55 </span><span class="caption-text">Record <strong>LAYER.1</strong>.</span><a class="headerlink" href="#tab-layer-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NLAY</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of horizontal grid layers.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-layer-2">
<caption><span class="caption-number">Table 56 </span><span class="caption-text">Record <strong>LAYER.2</strong>.</span><a class="headerlink" href="#tab-layer-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">H(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NLAY</span></code> layer thicknesses, from top layer downward. By default, zero or blank entries for layer thickness will result in assignment of the last preceding non-zero entry. Assignment of a zero layer thickness, as needed for inactive layers, can be accomplished by specifying a negative value.</p></td>
</tr>
</tbody>
</table>
<p>The LAYER data close the RZ2D data block.
Note that one blank record must follow to indicate termination of the <strong>MESHM</strong> data block.
Alternatively, keyword MINC can appear to invoke MINC-processing for fractured media (see below).</p>
</section>
</section>
<section id="generation-of-rectilinear-grids">
<h3>Generation of rectilinear grids<a class="headerlink" href="#generation-of-rectilinear-grids" title="Link to this heading">#</a></h3>
<section id="xyz">
<h4>XYZ<a class="headerlink" href="#xyz" title="Link to this heading">#</a></h4>
<p>Invokes generation of a Cartesian (rectilinear) mesh.</p>
<table class="table table-center" id="tab-xyz-1">
<caption><span class="caption-number">Table 57 </span><span class="caption-text">Record <strong>XYZ.1</strong>.</span><a class="headerlink" href="#tab-xyz-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DEG</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>angle (in degrees) between the Y-axis and the horizontal. If gravitational acceleration (parameter <code class="docutils literal notranslate"><span class="pre">GF</span></code> in record <strong>PARAM.2</strong>) is specified positive, -90° &lt; <code class="docutils literal notranslate"><span class="pre">DEG</span></code> &lt; 90° corresponds to grid layers going from top down. Grids can be specified from bottom layer up by setting <code class="docutils literal notranslate"><span class="pre">GF</span></code> or <code class="docutils literal notranslate"><span class="pre">BETA</span></code> negative. Default (<code class="docutils literal notranslate"><span class="pre">DEG</span></code> = 0) corresponds to horizontal Y- and vertical Z-axis. X-axis is always horizontal.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-xyz-2">
<caption><span class="caption-number">Table 58 </span><span class="caption-text">Record <strong>XYZ.2</strong>.</span><a class="headerlink" href="#tab-xyz-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NTYPE</span></code></p></td>
<td><p>A2</p></td>
<td><p>set equal to NX, NY or NZ for specifying grid increments in X, Y, or Z direction.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>3X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NO</span></code></p></td>
<td><p>I5</p></td>
<td><p>number of grid increments desired.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DEL</span></code></p></td>
<td><p>E10.4</p></td>
<td><p>constant grid increment for <code class="docutils literal notranslate"><span class="pre">NO</span></code> grid blocks, if set to a non-zero value.</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-xyz-3">
<caption><span class="caption-number">Table 59 </span><span class="caption-text">Record <strong>XYZ.3</strong>.</span><a class="headerlink" href="#tab-xyz-3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DEL(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NO</span></code> grid increments in the direction specified by <code class="docutils literal notranslate"><span class="pre">NTYPE</span></code> in record XYZ.2. Additional records with formats as XYZ.2 and XYZ.3 can be provided, with X, Y, and Z-data in arbitrary order.</p></td>
</tr>
</tbody>
</table>
<p>A blank record closes the XYZ data block.</p>
<p>Note that the end of block MESHMaker is also marked by a blank record.
Thus, when MESHMaker/XYZ is used, there will be two blank records at the end of the corresponding input data block.</p>
</section>
</section>
<section id="minc-processing-for-fractured-media">
<h3>MINC processing for fractured media<a class="headerlink" href="#minc-processing-for-fractured-media" title="Link to this heading">#</a></h3>
<section id="minc">
<h4>MINC<a class="headerlink" href="#minc" title="Link to this heading">#</a></h4>
<p>Invokes postprocessing of a primary porous medium mesh from file MESH.
The input formats in data block MINC are identical to those of the <em>GMINC</em> program (<span id="id17"><a class="reference internal" href="../references.html#id79" title="Pruess, K. (1983). GMINC: A mesh generator for flow simulations in fractured reservoirs. Lawrence Berkeley Lab., CA (USA).">Pruess, 1983</a></span>), with two enhancements: there is an additional facility for specifying global matrix-matrix connections (“dual permeability”); further, only active elements will be subjected to MINC-processing, the remainder of the MESH remaining unaltered as porous medium grid blocks.</p>
</section>
<section id="part">
<h4>PART<a class="headerlink" href="#part" title="Link to this heading">#</a></h4>
<p>PART is the first keyword following MINC; it will be followed on the same line by parameters <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> and <code class="docutils literal notranslate"><span class="pre">DUAL</span></code> with information on the nature of fracture distributions and matrix-matrix connections.</p>
<table class="table table-center" id="tab-part-1">
<caption><span class="caption-number">Table 60 </span><span class="caption-text">Record <strong>PART.1</strong>.</span><a class="headerlink" href="#tab-part-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PART</span></code></p></td>
<td><p>A5</p></td>
<td><p>identifier of data block with partitioning parameters for secondary mesh.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TYPE</span></code></p></td>
<td><p>A5</p></td>
<td><div class="line-block">
<div class="line">a five-character word for selecting one of the six different proximity functions provided in MINC (<span id="id18"><a class="reference internal" href="../references.html#id79" title="Pruess, K. (1983). GMINC: A mesh generator for flow simulations in fractured reservoirs. Lawrence Berkeley Lab., CA (USA).">Pruess, 1983</a></span>):</div>
<div class="line">ONE-D: a set of plane parallel infinite fractures with matrix block thickness between neighboring fractures equal to <code class="docutils literal notranslate"><span class="pre">PAR(1)</span></code>.</div>
<div class="line">TWO-D: two sets of plane parallel infinite fractures, with arbitrary angle between them. Matrix block thickness is <code class="docutils literal notranslate"><span class="pre">PAR(1)</span></code> for the first set, and <code class="docutils literal notranslate"><span class="pre">PAR(2)</span></code> for the second set. If <code class="docutils literal notranslate"><span class="pre">PAR(2)</span></code> is not specified explicitly, it will be set equal to <code class="docutils literal notranslate"><span class="pre">PAR(1)</span></code>.</div>
<div class="line">THRED: three sets of plane parallel infinite fractures at right angles, with matrix block dimensions of <code class="docutils literal notranslate"><span class="pre">PAR(1)</span></code>, <code class="docutils literal notranslate"><span class="pre">PAR(2)</span></code>, and <code class="docutils literal notranslate"><span class="pre">PAR(3)</span></code>, respectively. If <code class="docutils literal notranslate"><span class="pre">PAR(2)</span></code> and/or <code class="docutils literal notranslate"><span class="pre">PAR(3)</span></code> are not explicitly specified, they will be set equal to <code class="docutils literal notranslate"><span class="pre">PAR(1)</span></code> and/or <code class="docutils literal notranslate"><span class="pre">PAR(2)</span></code>, respectively.</div>
<div class="line">STANA: average proximity function for rock loading of Stanford large reservoir model (<span id="id19"><a class="reference internal" href="../references.html#id45" title="Lam, S., Hunsbedt, A., Kruger, P., &amp; Pruess, K. (1988). Analysis of the stanford geothermal reservoir model experiments using the lbl reservoir simulator. Geothermics, 17(4), 595–605.">Lam et al., 1988</a></span>).</div>
<div class="line">STANB: proximity function for the five bottom layers of Stanford large reservoir model.</div>
<div class="line">STANT: proximity function for top layer of Stanford large reservoir model.</div>
<div class="line"><br /></div>
<div class="line">Note: a user wishing to employ a different proximity function than provided in MINC needs to replace the function subprogram PROX(x) in file <em>Mesh_Maker.f90</em> with a routine of the form:</div>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION </span><span class="n">PROX</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">PROX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">arithmetic</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="k">RETURN</span>
<span class="k">END</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">It is necessary that PROX(x) is defined even when x exceeds the maximum possible distance from the fractures, and that PROX = 1 in this case. Also, when the user supplies his/her own proximity function subprogram, the parameter <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> has to be chosen equal to ONE-D, TWO-D, or THRED, depending on the dimensionality of the proximity function. This will assure proper definition of innermost nodal distance (<span id="id20"><a class="reference internal" href="../references.html#id79" title="Pruess, K. (1983). GMINC: A mesh generator for flow simulations in fractured reservoirs. Lawrence Berkeley Lab., CA (USA).">Pruess, 1983</a></span>).</div>
</div>
</td>
</tr>
<tr class="row-even"><td></td>
<td><p>5X</p></td>
<td><p>(void)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DUAL</span></code></p></td>
<td><p>A5</p></td>
<td><div class="line-block">
<div class="line">a five-character word for selecting the treatment of global matrix matrix flow:</div>
<div class="line">blank:  (default) global flow occurs only through the fracture continuum, while rock matrix and fractures interact locally by means of interporosity flow (“double-porosity” model).</div>
<div class="line">MMVER: global matrix-matrix flow is permitted only in the vertical; otherwise like the double-porosity model; for internal consistency this choice should only be made for flow systems with one or two predominantly vertical fracture sets.</div>
<div class="line">MMALL:  global matrix-matrix flow in all directions; for internal consistency only two continua, representing matrix and fractures, should be specified (“dual-permeability”).</div>
</div>
</td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-part-2">
<caption><span class="caption-number">Table 61 </span><span class="caption-text">Record <strong>PART.2</strong>.</span><a class="headerlink" href="#tab-part-2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">J</span></code></p></td>
<td><p>I3</p></td>
<td><p>total number of multiple interacting continua.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NVOL</span></code></p></td>
<td><p>I3</p></td>
<td><p>total number of explicitly provided volume fractions (<code class="docutils literal notranslate"><span class="pre">NVOL</span></code> &lt; J). If <code class="docutils literal notranslate"><span class="pre">NVOL</span></code> &lt; J, the volume fractions with indices <code class="docutils literal notranslate"><span class="pre">NVOL</span></code> + 1, …, <code class="docutils literal notranslate"><span class="pre">J</span></code> will be internally generated; all being equal and chosen such as to yield proper normalization to 1.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">WHERE</span></code></p></td>
<td><p>A4</p></td>
<td><p>specifies whether the sequentially specified volume fractions begin with the fractures (<code class="docutils literal notranslate"><span class="pre">WHERE</span></code> = OUT) or in the interior of the matrix blocks (<code class="docutils literal notranslate"><span class="pre">WHERE</span></code> = IN).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PAR(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, 7 holds parameters for fracture spacing (see above).</p></td>
</tr>
</tbody>
</table>
<table class="table table-center" id="tab-part-2-1">
<caption><span class="caption-number">Table 62 </span><span class="caption-text">Record <strong>PART.2.1</strong>.</span><a class="headerlink" href="#tab-part-2-1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 12.5%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">VOL(I)</span></code></p></td>
<td><p>E10.4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">I</span></code> = 1, <code class="docutils literal notranslate"><span class="pre">NVOL</span></code> volume fraction (between 0 and 1) of continuum with index <code class="docutils literal notranslate"><span class="pre">I</span></code> (for <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> = OUT) or index <code class="docutils literal notranslate"><span class="pre">J</span></code> + 1 -  <code class="docutils literal notranslate"><span class="pre">I</span></code> (for <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> = IN). <code class="docutils literal notranslate"><span class="pre">NVOL</span></code> volume fractions will be read. For <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> = OUT , <code class="docutils literal notranslate"><span class="pre">I</span></code> = 1 is the fracture continuum, <code class="docutils literal notranslate"><span class="pre">I</span></code> = 2 is the matrix continuum closest to the fractures, <code class="docutils literal notranslate"><span class="pre">I</span></code> = 3 is the matrix continuum adjacent to <code class="docutils literal notranslate"><span class="pre">I</span></code> = 2, etc. The sum of all volume fractions must not exceed 1.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="initial_and_boundary_conditions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Initial and Boundary Conditions</p>
      </div>
    </a>
    <a class="right-next"
       href="output_from_tough3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Output from TOUGH3</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tough3-input-data">TOUGH3 Input Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tough3-input-format">TOUGH3 Input Format</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#title">TITLE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rocks">ROCKS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi">MULTI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#start-optional">START (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#param">PARAM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indom">INDOM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#incon">INCON</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solvr-optional">SOLVR (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#foft-optional">FOFT (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coft-optional">COFT (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#goft-optional">GOFT (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffu-optional">DIFFU (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selec">SELEC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rpcap">RPCAP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hyste-optional">HYSTE (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#times-optional">TIMES (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eleme">ELEME</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conne">CONNE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gener">GENER</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timbc">TIMBC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#momop-optional">MOMOP (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outpu-optional">OUTPU (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#endcy">ENDCY</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometry-data">Geometry Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-concepts">General concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meshmaker">Meshmaker</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-porosity-processing">Multiple-porosity processing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input-formats-for-meshmaker">Input Formats for MESHMAKER</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generation-of-radially-symmetric-grid">Generation of radially symmetric grid</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#radii">RADII</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#equid">EQUID</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logar">LOGAR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#layer">LAYER</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generation-of-rectilinear-grids">Generation of rectilinear grids</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xyz">XYZ</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minc-processing-for-fractured-media">MINC processing for fractured media</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minc">MINC</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#part">PART</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/tough3/guide/preparation_of_input_data.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Keurfon Luu.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>